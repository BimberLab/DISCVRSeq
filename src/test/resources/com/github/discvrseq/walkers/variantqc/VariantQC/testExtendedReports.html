<script type="text/javascript">
mqc_plots = {};
num_datasets_plot_limit = 50;
$(function() {
$('#dateTime').html('Generated on: *Timestamp*');
processPlots({
sections:
[{"label":"Entire VCF","reports":[{"label":"Variant Summary","data":{"plot_type":"data_table","samples":["drivingVariantFile / called","drivingVariantFile / filtered","drivingVariantFile / raw"],"datasets":[["called",16000,16,12,4,2.5E-4,4000.0,3,0,1,0,0,0,0,12,4,16,0,3,0,2.5E-4,4000.0,4.0,6.25E-5,16000.0,1.0],["filtered",16000,0,0,0,0.0,0.0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,0.0,0.0],["raw",16000,16,12,4,2.5E-4,4000.0,3,0,1,0,0,0,0,12,4,16,0,3,0,2.5E-4,4000.0,4.0,6.25E-5,16000.0,1.0]],"columns":[{"name":"Filter","label":"Filter"},{"name":"nProcessedLoci","label":"nProcessedLoci","formatString":"0,0","flagAbove":16000.0,"flagBelow":16000.0,"dmin":14400.0,"dmax":17600.0},{"name":"nCalledLoci","label":"nCalledLoci","formatString":"0,0","flagAbove":29.141875280734695,"flagBelow":-7.808541947401361,"dmin":0.0,"dmax":17.6},{"name":"nRefLoci","label":"nRefLoci","formatString":"0,0","flagAbove":21.856406460551018,"flagBelow":-5.8564064605510175,"dmin":0.0,"dmax":13.2},{"name":"nVariantLoci","label":"nVariantLoci","formatString":"0,0","flagAbove":7.285468820183674,"flagBelow":-1.9521354868503402,"dmin":0.0,"dmax":4.4},{"name":"variantRate","label":"variantRate","flagAbove":4.5534180126147953E-4,"flagBelow":-1.2200846792814624E-4,"dmin":0.0,"dmax":2.750000130617991E-4},{"name":"variantRatePerBp","label":"variantRatePerBp","flagAbove":7285.4688201836725,"flagBelow":-1952.135486850339,"dmin":0.0,"dmax":4400.0},{"name":"nSNPs","label":"nSNPs","formatString":"0,0","flagAbove":5.464101615137754,"flagBelow":-1.4641016151377544,"dmin":0.0,"dmax":3.3},{"name":"nMNPs","label":"nMNPs","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nInsertions","label":"nInsertions","formatString":"0,0","flagAbove":1.8213672050459184,"flagBelow":-0.48803387171258505,"dmin":0.0,"dmax":1.1},{"name":"nDeletions","label":"nDeletions","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nComplex","label":"nComplex","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nSymbolic","label":"nSymbolic","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nMixed","label":"nMixed","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nNoCalls","label":"nNoCalls","formatString":"0,0","flagAbove":21.856406460551018,"flagBelow":-5.8564064605510175,"dmin":0.0,"dmax":13.2},{"name":"nHets","label":"nHets","formatString":"0,0","flagAbove":7.285468820183674,"flagBelow":-1.9521354868503402,"dmin":0.0,"dmax":4.4},{"name":"nHomRef","label":"nHomRef","formatString":"0,0","flagAbove":29.141875280734695,"flagBelow":-7.808541947401361,"dmin":0.0,"dmax":17.6},{"name":"nHomVar","label":"nHomVar","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nSingletons","label":"nSingletons","formatString":"0,0","flagAbove":5.464101615137754,"flagBelow":-1.4641016151377544,"dmin":0.0,"dmax":3.3},{"name":"nHomDerived","label":"nHomDerived","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"heterozygosity","label":"heterozygosity","flagAbove":4.5534180126147953E-4,"flagBelow":-1.2200846792814624E-4,"dmin":0.0,"dmax":2.750000130617991E-4},{"name":"heterozygosityPerBp","label":"heterozygosityPerBp","flagAbove":7285.4688201836725,"flagBelow":-1952.135486850339,"dmin":0.0,"dmax":4400.0},{"name":"hetHomRatio","label":"hetHomRatio","flagAbove":7.285468820183674,"flagBelow":-1.9521354868503402,"dmin":0.0,"dmax":4.4},{"name":"indelRate","label":"indelRate","flagAbove":1.1383545031536988E-4,"flagBelow":-3.050211698203656E-5,"dmin":0.0,"dmax":6.875000326544978E-5},{"name":"indelRatePerBp","label":"indelRatePerBp","flagAbove":29141.87528073469,"flagBelow":-7808.541947401356,"dmin":0.0,"dmax":17600.0},{"name":"insertionDeletionRatio","label":"insertionDeletionRatio","flagAbove":1.8213672050459184,"flagBelow":-0.48803387171258505,"dmin":0.0,"dmax":1.1}]}},{"label":"Variant Type","data":{"plot_type":"bar_graph","samples":[["drivingVariantFile / called","drivingVariantFile / filtered","drivingVariantFile / raw"]],"datasets":[[{"name":"nSNPs","data":[3,0,3]},{"name":"nMNPs","data":[0,0,0]},{"name":"nInsertions","data":[1,0,1]},{"name":"nDeletions","data":[0,0,0]},{"name":"nComplex","data":[0,0,0]},{"name":"nSymbolic","data":[0,0,0]},{"name":"nMixed","data":[0,0,0]}]],"config":{"ylab":"# Variants","title":"Variant Type"}}},{"label":"Genotype Summary","data":{"plot_type":"data_table","samples":["drivingVariantFile / called","drivingVariantFile / filtered","drivingVariantFile / raw"],"datasets":[["called",20,12],["filtered",0,0],["raw",20,12]],"columns":[{"name":"Filter","label":"Filter"},{"name":"nCalledNotFiltered","label":"nCalledNotFiltered","formatString":"0,0","flagAbove":36.42734410091837,"flagBelow":-9.760677434251699,"dmin":0.0,"dmax":22.0},{"name":"nNoCallOrFiltered","label":"nNoCallOrFiltered","formatString":"0,0","flagAbove":21.856406460551018,"flagBelow":-5.8564064605510175,"dmin":0.0,"dmax":13.2}]}},{"label":"SNP/Indel Summary","data":{"plot_type":"data_table","samples":["drivingVariantFile / called","drivingVariantFile / filtered","drivingVariantFile / raw"],"datasets":[["called",3,3,1,1,"0","0.00","3.00","3.00",1,"100.00","1","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["filtered",0,0,0,0,"0","NA","NA","NA",0,"NA","0","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["raw",3,3,1,1,"0","0.00","3.00","3.00",1,"100.00","1","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"]],"columns":[{"name":"Filter","label":"Filter"},{"name":"n_SNPs","label":"n_SNPs","formatString":"0,0","flagAbove":5.464101615137754,"flagBelow":-1.4641016151377544,"dmin":0.0,"dmax":3.3},{"name":"n_singleton_SNPs","label":"n_singleton_SNPs","formatString":"0,0","flagAbove":5.464101615137754,"flagBelow":-1.4641016151377544,"dmin":0.0,"dmax":3.3},{"name":"n_indels","label":"n_indels","formatString":"0,0","flagAbove":1.8213672050459184,"flagBelow":-0.48803387171258505,"dmin":0.0,"dmax":1.1},{"name":"n_singleton_indels","label":"n_singleton_indels","formatString":"0,0","flagAbove":1.8213672050459184,"flagBelow":-0.48803387171258505,"dmin":0.0,"dmax":1.1},{"name":"n_multiallelic_indel_sites","label":"n_multiallelic_indel_sites"},{"name":"percent_of_sites_with_more_than_2_alleles","label":"percent_of_sites_with_more_than_2_alleles"},{"name":"SNP_to_indel_ratio","label":"SNP_to_indel_ratio"},{"name":"SNP_to_indel_ratio_for_singletons","label":"SNP_to_indel_ratio_for_singletons"},{"name":"n_novel_indels","label":"n_novel_indels","formatString":"0,0","flagAbove":1.8213672050459184,"flagBelow":-0.48803387171258505,"dmin":0.0,"dmax":1.1},{"name":"indel_novelty_rate","label":"indel_novelty_rate"},{"name":"n_insertions","label":"n_insertions"},{"name":"n_deletions","label":"n_deletions"},{"name":"insertion_to_deletion_ratio","label":"insertion_to_deletion_ratio"},{"name":"n_large_deletions","label":"n_large_deletions"},{"name":"n_large_insertions","label":"n_large_insertions"},{"name":"insertion_to_deletion_ratio_for_large_indels","label":"insertion_to_deletion_ratio_for_large_indels"},{"name":"n_coding_indels_frameshifting","label":"n_coding_indels_frameshifting"},{"name":"n_coding_indels_in_frame","label":"n_coding_indels_in_frame"},{"name":"frameshift_rate_for_coding_indels","label":"frameshift_rate_for_coding_indels"},{"name":"SNP_het_to_hom_ratio","label":"SNP_het_to_hom_ratio"},{"name":"indel_het_to_hom_ratio","label":"indel_het_to_hom_ratio"},{"name":"ratio_of_1_and_2_to_3_bp_insertions","label":"ratio_of_1_and_2_to_3_bp_insertions"},{"name":"ratio_of_1_and_2_to_3_bp_deletions","label":"ratio_of_1_and_2_to_3_bp_deletions"}]}},{"label":"Ti/Tv Data","data":{"plot_type":"data_table","samples":["drivingVariantFile / called","drivingVariantFile / filtered","drivingVariantFile / raw"],"datasets":[["called",2,1,2.0,0,0,0.0,0,0,0.0],["filtered",0,0,0.0,0,0,0.0,0,0,0.0],["raw",2,1,2.0,0,0,0.0,0,0,0.0]],"columns":[{"name":"Filter","label":"Filter"},{"name":"nTi","label":"nTi","formatString":"0,0","flagAbove":3.642734410091837,"flagBelow":-0.9760677434251701,"dmin":0.0,"dmax":2.2},{"name":"nTv","label":"nTv","formatString":"0,0","flagAbove":1.8213672050459184,"flagBelow":-0.48803387171258505,"dmin":0.0,"dmax":1.1},{"name":"tiTvRatio","label":"tiTvRatio","flagAbove":3.642734410091837,"flagBelow":-0.9760677434251701,"dmin":0.0,"dmax":2.2},{"name":"nTiInComp","label":"nTiInComp","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nTvInComp","label":"nTvInComp","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"TiTvRatioStandard","label":"TiTvRatioStandard","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nTiDerived","label":"nTiDerived","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nTvDerived","label":"nTvDerived","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"tiTvDerivedRatio","label":"tiTvDerivedRatio","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0}]}},{"label":"Variant Summary By Filter","data":{"plot_type":"data_table","samples":["drivingVariantFile"],"datasets":[[16]],"columns":[{"name":"PASS","label":"PASS","formatString":"0,0","flagAbove":16.0,"flagBelow":16.0,"dmin":14.4,"dmax":17.6}]}},{"label":"Filter Type","data":{"plot_type":"bar_graph","samples":[["drivingVariantFile"]],"datasets":[[{"name":"PASS","data":[16]}]],"config":{"ylab":"# Variants","title":"Filter Type"}}}]},{"label":"By Contig","reports":[{"label":"Variant Summary","data":{"plot_type":"data_table","samples":["1 / called","1 / filtered","1 / raw","2 / called","2 / filtered","2 / raw","all / called","all / filtered","all / raw"],"datasets":[["1","called",16000,16,12,4,2.5E-4,4000.0,3,0,1,0,0,0,0,12,4,16,0,3,0,2.5E-4,4000.0,4.0,6.25E-5,16000.0,1.0],["1","filtered",16000,0,0,0,0.0,0.0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,0.0,0.0],["1","raw",16000,16,12,4,2.5E-4,4000.0,3,0,1,0,0,0,0,12,4,16,0,3,0,2.5E-4,4000.0,4.0,6.25E-5,16000.0,1.0],["2","called",16000,0,0,0,0.0,0.0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,0.0,0.0],["2","filtered",16000,0,0,0,0.0,0.0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,0.0,0.0],["2","raw",16000,0,0,0,0.0,0.0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,0.0,0.0],["all","called",16000,16,12,4,2.5E-4,4000.0,3,0,1,0,0,0,0,12,4,16,0,3,0,2.5E-4,4000.0,4.0,6.25E-5,16000.0,1.0],["all","filtered",16000,0,0,0,0.0,0.0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,0.0,0.0],["all","raw",16000,16,12,4,2.5E-4,4000.0,3,0,1,0,0,0,0,12,4,16,0,3,0,2.5E-4,4000.0,4.0,6.25E-5,16000.0,1.0]],"columns":[{"name":"Contig","label":"Contig"},{"name":"Filter","label":"Filter"},{"name":"nProcessedLoci","label":"nProcessedLoci","formatString":"0,0","flagAbove":16000.0,"flagBelow":16000.0,"dmin":14400.0,"dmax":17600.0},{"name":"nCalledLoci","label":"nCalledLoci","formatString":"0,0","flagAbove":23.976591965342468,"flagBelow":-9.754369743120247,"dmin":0.0,"dmax":17.6},{"name":"nRefLoci","label":"nRefLoci","formatString":"0,0","flagAbove":17.982443974006852,"flagBelow":-7.315777307340185,"dmin":0.0,"dmax":13.2},{"name":"nVariantLoci","label":"nVariantLoci","formatString":"0,0","flagAbove":5.994147991335617,"flagBelow":-2.4385924357800617,"dmin":0.0,"dmax":4.4},{"name":"variantRate","label":"variantRate","flagAbove":3.746342494584761E-4,"flagBelow":-1.5241202723625385E-4,"dmin":0.0,"dmax":2.750000130617991E-4},{"name":"variantRatePerBp","label":"variantRatePerBp","flagAbove":5994.147991335616,"flagBelow":-2438.592435780061,"dmin":0.0,"dmax":4400.0},{"name":"nSNPs","label":"nSNPs","formatString":"0,0","flagAbove":4.495610993501713,"flagBelow":-1.8289443268350463,"dmin":0.0,"dmax":3.3},{"name":"nMNPs","label":"nMNPs","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nInsertions","label":"nInsertions","formatString":"0,0","flagAbove":1.4985369978339043,"flagBelow":-0.6096481089450154,"dmin":0.0,"dmax":1.1},{"name":"nDeletions","label":"nDeletions","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nComplex","label":"nComplex","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nSymbolic","label":"nSymbolic","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nMixed","label":"nMixed","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nNoCalls","label":"nNoCalls","formatString":"0,0","flagAbove":17.982443974006852,"flagBelow":-7.315777307340185,"dmin":0.0,"dmax":13.2},{"name":"nHets","label":"nHets","formatString":"0,0","flagAbove":5.994147991335617,"flagBelow":-2.4385924357800617,"dmin":0.0,"dmax":4.4},{"name":"nHomRef","label":"nHomRef","formatString":"0,0","flagAbove":23.976591965342468,"flagBelow":-9.754369743120247,"dmin":0.0,"dmax":17.6},{"name":"nHomVar","label":"nHomVar","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nSingletons","label":"nSingletons","formatString":"0,0","flagAbove":4.495610993501713,"flagBelow":-1.8289443268350463,"dmin":0.0,"dmax":3.3},{"name":"nHomDerived","label":"nHomDerived","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"heterozygosity","label":"heterozygosity","flagAbove":3.746342494584761E-4,"flagBelow":-1.5241202723625385E-4,"dmin":0.0,"dmax":2.750000130617991E-4},{"name":"heterozygosityPerBp","label":"heterozygosityPerBp","flagAbove":5994.147991335616,"flagBelow":-2438.592435780061,"dmin":0.0,"dmax":4400.0},{"name":"hetHomRatio","label":"hetHomRatio","flagAbove":5.994147991335617,"flagBelow":-2.4385924357800617,"dmin":0.0,"dmax":4.4},{"name":"indelRate","label":"indelRate","flagAbove":9.365856236461903E-5,"flagBelow":-3.810300680906346E-5,"dmin":0.0,"dmax":6.875000326544978E-5},{"name":"indelRatePerBp","label":"indelRatePerBp","flagAbove":23976.591965342464,"flagBelow":-9754.369743120244,"dmin":0.0,"dmax":17600.0},{"name":"insertionDeletionRatio","label":"insertionDeletionRatio","flagAbove":1.4985369978339043,"flagBelow":-0.6096481089450154,"dmin":0.0,"dmax":1.1}]}},{"label":"Variant Type","data":{"plot_type":"bar_graph","samples":[["1 / called","1 / filtered","1 / raw","2 / called","2 / filtered","2 / raw","all / called","all / filtered","all / raw"]],"datasets":[[{"name":"nSNPs","data":[3,0,3,0,0,0,3,0,3]},{"name":"nMNPs","data":[0,0,0,0,0,0,0,0,0]},{"name":"nInsertions","data":[1,0,1,0,0,0,1,0,1]},{"name":"nDeletions","data":[0,0,0,0,0,0,0,0,0]},{"name":"nComplex","data":[0,0,0,0,0,0,0,0,0]},{"name":"nSymbolic","data":[0,0,0,0,0,0,0,0,0]},{"name":"nMixed","data":[0,0,0,0,0,0,0,0,0]}]],"config":{"ylab":"# Variants","title":"Variant Type"}}},{"label":"Genotype Summary","data":{"plot_type":"data_table","samples":["1 / called","1 / filtered","1 / raw","2 / called","2 / filtered","2 / raw","all / called","all / filtered","all / raw"],"datasets":[["1","called",20,12],["1","filtered",0,0],["1","raw",20,12],["2","called",0,0],["2","filtered",0,0],["2","raw",0,0],["all","called",20,12],["all","filtered",0,0],["all","raw",20,12]],"columns":[{"name":"Contig","label":"Contig"},{"name":"Filter","label":"Filter"},{"name":"nCalledNotFiltered","label":"nCalledNotFiltered","formatString":"0,0","flagAbove":29.970739956678088,"flagBelow":-12.19296217890031,"dmin":0.0,"dmax":22.0},{"name":"nNoCallOrFiltered","label":"nNoCallOrFiltered","formatString":"0,0","flagAbove":17.982443974006852,"flagBelow":-7.315777307340185,"dmin":0.0,"dmax":13.2}]}},{"label":"SNP/Indel Summary","data":{"plot_type":"data_table","samples":["1 / called","1 / filtered","1 / raw","2 / called","2 / filtered","2 / raw","all / called","all / filtered","all / raw"],"datasets":[["1","called",3,3,1,1,"0","0.00","3.00","3.00",1,"100.00","1","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["1","filtered",0,0,0,0,"0","NA","NA","NA",0,"NA","0","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["1","raw",3,3,1,1,"0","0.00","3.00","3.00",1,"100.00","1","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["2","called",0,0,0,0,"0","NA","NA","NA",0,"NA","0","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["2","filtered",0,0,0,0,"0","NA","NA","NA",0,"NA","0","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["2","raw",0,0,0,0,"0","NA","NA","NA",0,"NA","0","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["all","called",3,3,1,1,"0","0.00","3.00","3.00",1,"100.00","1","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["all","filtered",0,0,0,0,"0","NA","NA","NA",0,"NA","0","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["all","raw",3,3,1,1,"0","0.00","3.00","3.00",1,"100.00","1","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"]],"columns":[{"name":"Contig","label":"Contig"},{"name":"Filter","label":"Filter"},{"name":"n_SNPs","label":"n_SNPs","formatString":"0,0","flagAbove":4.495610993501713,"flagBelow":-1.8289443268350463,"dmin":0.0,"dmax":3.3},{"name":"n_singleton_SNPs","label":"n_singleton_SNPs","formatString":"0,0","flagAbove":4.495610993501713,"flagBelow":-1.8289443268350463,"dmin":0.0,"dmax":3.3},{"name":"n_indels","label":"n_indels","formatString":"0,0","flagAbove":1.4985369978339043,"flagBelow":-0.6096481089450154,"dmin":0.0,"dmax":1.1},{"name":"n_singleton_indels","label":"n_singleton_indels","formatString":"0,0","flagAbove":1.4985369978339043,"flagBelow":-0.6096481089450154,"dmin":0.0,"dmax":1.1},{"name":"n_multiallelic_indel_sites","label":"n_multiallelic_indel_sites"},{"name":"percent_of_sites_with_more_than_2_alleles","label":"percent_of_sites_with_more_than_2_alleles"},{"name":"SNP_to_indel_ratio","label":"SNP_to_indel_ratio"},{"name":"SNP_to_indel_ratio_for_singletons","label":"SNP_to_indel_ratio_for_singletons"},{"name":"n_novel_indels","label":"n_novel_indels","formatString":"0,0","flagAbove":1.4985369978339043,"flagBelow":-0.6096481089450154,"dmin":0.0,"dmax":1.1},{"name":"indel_novelty_rate","label":"indel_novelty_rate"},{"name":"n_insertions","label":"n_insertions"},{"name":"n_deletions","label":"n_deletions"},{"name":"insertion_to_deletion_ratio","label":"insertion_to_deletion_ratio"},{"name":"n_large_deletions","label":"n_large_deletions"},{"name":"n_large_insertions","label":"n_large_insertions"},{"name":"insertion_to_deletion_ratio_for_large_indels","label":"insertion_to_deletion_ratio_for_large_indels"},{"name":"n_coding_indels_frameshifting","label":"n_coding_indels_frameshifting"},{"name":"n_coding_indels_in_frame","label":"n_coding_indels_in_frame"},{"name":"frameshift_rate_for_coding_indels","label":"frameshift_rate_for_coding_indels"},{"name":"SNP_het_to_hom_ratio","label":"SNP_het_to_hom_ratio"},{"name":"indel_het_to_hom_ratio","label":"indel_het_to_hom_ratio"},{"name":"ratio_of_1_and_2_to_3_bp_insertions","label":"ratio_of_1_and_2_to_3_bp_insertions"},{"name":"ratio_of_1_and_2_to_3_bp_deletions","label":"ratio_of_1_and_2_to_3_bp_deletions"}]}},{"label":"Purpose Report2","data":{"plot_type":"data_table","samples":["1 / called","1 / filtered","1 / raw","2 / called","2 / filtered","2 / raw","all / called","all / filtered","all / raw"],"datasets":[["1","called","all","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["1","called","all","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["1","called","all","diff_pos_same_ref_same_alt","1"],["1","called","all","same_pos_same_ref_same_alt1_same_alt2","1"],["1","called","all","same_pos_same_ref_diff_alt1_same_alt2","1"],["1","called","all","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["1","called","all","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["1","called","all","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["1","called","all","same_pos_diff_ref_same_alt","1"],["1","called","all","same_pos_same_ref_diff_alt","1"],["1","called","all","same_pos_same_ref_same_alt","1"],["1","called","all","overlapping_position","1"],["1","called","all","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["1","called","all","same_pos_same_ref_same_alt1_diff_alt2","1"],["1","called","all","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["1","called","all","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["1","called","sample1","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["1","called","sample1","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["1","called","sample1","diff_pos_same_ref_same_alt","1"],["1","called","sample1","same_pos_same_ref_same_alt1_same_alt2","1"],["1","called","sample1","same_pos_same_ref_diff_alt1_same_alt2","1"],["1","called","sample1","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["1","called","sample1","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["1","called","sample1","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["1","called","sample1","same_pos_diff_ref_same_alt","1"],["1","called","sample1","same_pos_same_ref_diff_alt","1"],["1","called","sample1","same_pos_same_ref_same_alt","1"],["1","called","sample1","overlapping_position","1"],["1","called","sample1","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["1","called","sample1","same_pos_same_ref_same_alt1_diff_alt2","1"],["1","called","sample1","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["1","called","sample1","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["1","called","sample2","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["1","called","sample2","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["1","called","sample2","diff_pos_same_ref_same_alt","1"],["1","called","sample2","same_pos_same_ref_same_alt1_same_alt2","1"],["1","called","sample2","same_pos_same_ref_diff_alt1_same_alt2","1"],["1","called","sample2","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["1","called","sample2","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["1","called","sample2","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["1","called","sample2","same_pos_diff_ref_same_alt","1"],["1","called","sample2","same_pos_same_ref_diff_alt","1"],["1","called","sample2","same_pos_same_ref_same_alt","1"],["1","called","sample2","overlapping_position","1"],["1","called","sample2","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["1","called","sample2","same_pos_same_ref_same_alt1_diff_alt2","1"],["1","called","sample2","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["1","called","sample2","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["1","filtered","all","Empty/Blank","0"],["1","filtered","sample1","Empty/Blank","0"],["1","filtered","sample2","Empty/Blank","0"],["1","raw","all","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["1","raw","all","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["1","raw","all","diff_pos_same_ref_same_alt","1"],["1","raw","all","same_pos_same_ref_same_alt1_same_alt2","1"],["1","raw","all","same_pos_same_ref_diff_alt1_same_alt2","1"],["1","raw","all","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["1","raw","all","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["1","raw","all","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["1","raw","all","same_pos_diff_ref_same_alt","1"],["1","raw","all","same_pos_same_ref_diff_alt","1"],["1","raw","all","same_pos_same_ref_same_alt","1"],["1","raw","all","overlapping_position","1"],["1","raw","all","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["1","raw","all","same_pos_same_ref_same_alt1_diff_alt2","1"],["1","raw","all","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["1","raw","all","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["1","raw","sample1","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["1","raw","sample1","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["1","raw","sample1","diff_pos_same_ref_same_alt","1"],["1","raw","sample1","same_pos_same_ref_same_alt1_same_alt2","1"],["1","raw","sample1","same_pos_same_ref_diff_alt1_same_alt2","1"],["1","raw","sample1","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["1","raw","sample1","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["1","raw","sample1","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["1","raw","sample1","same_pos_diff_ref_same_alt","1"],["1","raw","sample1","same_pos_same_ref_diff_alt","1"],["1","raw","sample1","same_pos_same_ref_same_alt","1"],["1","raw","sample1","overlapping_position","1"],["1","raw","sample1","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["1","raw","sample1","same_pos_same_ref_same_alt1_diff_alt2","1"],["1","raw","sample1","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["1","raw","sample1","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["1","raw","sample2","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["1","raw","sample2","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["1","raw","sample2","diff_pos_same_ref_same_alt","1"],["1","raw","sample2","same_pos_same_ref_same_alt1_same_alt2","1"],["1","raw","sample2","same_pos_same_ref_diff_alt1_same_alt2","1"],["1","raw","sample2","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["1","raw","sample2","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["1","raw","sample2","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["1","raw","sample2","same_pos_diff_ref_same_alt","1"],["1","raw","sample2","same_pos_same_ref_diff_alt","1"],["1","raw","sample2","same_pos_same_ref_same_alt","1"],["1","raw","sample2","overlapping_position","1"],["1","raw","sample2","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["1","raw","sample2","same_pos_same_ref_same_alt1_diff_alt2","1"],["1","raw","sample2","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["1","raw","sample2","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["2","called","all","Empty/Blank","0"],["2","called","sample1","Empty/Blank","0"],["2","called","sample2","Empty/Blank","0"],["2","filtered","all","Empty/Blank","0"],["2","filtered","sample1","Empty/Blank","0"],["2","filtered","sample2","Empty/Blank","0"],["2","raw","all","Empty/Blank","0"],["2","raw","sample1","Empty/Blank","0"],["2","raw","sample2","Empty/Blank","0"],["all","called","all","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["all","called","all","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["all","called","all","diff_pos_same_ref_same_alt","1"],["all","called","all","same_pos_same_ref_same_alt1_same_alt2","1"],["all","called","all","same_pos_same_ref_diff_alt1_same_alt2","1"],["all","called","all","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["all","called","all","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["all","called","all","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["all","called","all","same_pos_diff_ref_same_alt","1"],["all","called","all","same_pos_same_ref_diff_alt","1"],["all","called","all","same_pos_same_ref_same_alt","1"],["all","called","all","overlapping_position","1"],["all","called","all","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["all","called","all","same_pos_same_ref_same_alt1_diff_alt2","1"],["all","called","all","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["all","called","all","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["all","called","sample1","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["all","called","sample1","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["all","called","sample1","diff_pos_same_ref_same_alt","1"],["all","called","sample1","same_pos_same_ref_same_alt1_same_alt2","1"],["all","called","sample1","same_pos_same_ref_diff_alt1_same_alt2","1"],["all","called","sample1","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["all","called","sample1","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["all","called","sample1","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["all","called","sample1","same_pos_diff_ref_same_alt","1"],["all","called","sample1","same_pos_same_ref_diff_alt","1"],["all","called","sample1","same_pos_same_ref_same_alt","1"],["all","called","sample1","overlapping_position","1"],["all","called","sample1","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["all","called","sample1","same_pos_same_ref_same_alt1_diff_alt2","1"],["all","called","sample1","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["all","called","sample1","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["all","called","sample2","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["all","called","sample2","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["all","called","sample2","diff_pos_same_ref_same_alt","1"],["all","called","sample2","same_pos_same_ref_same_alt1_same_alt2","1"],["all","called","sample2","same_pos_same_ref_diff_alt1_same_alt2","1"],["all","called","sample2","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["all","called","sample2","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["all","called","sample2","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["all","called","sample2","same_pos_diff_ref_same_alt","1"],["all","called","sample2","same_pos_same_ref_diff_alt","1"],["all","called","sample2","same_pos_same_ref_same_alt","1"],["all","called","sample2","overlapping_position","1"],["all","called","sample2","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["all","called","sample2","same_pos_same_ref_same_alt1_diff_alt2","1"],["all","called","sample2","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["all","called","sample2","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["all","filtered","all","Empty/Blank","0"],["all","filtered","sample1","Empty/Blank","0"],["all","filtered","sample2","Empty/Blank","0"],["all","raw","all","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["all","raw","all","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["all","raw","all","diff_pos_same_ref_same_alt","1"],["all","raw","all","same_pos_same_ref_same_alt1_same_alt2","1"],["all","raw","all","same_pos_same_ref_diff_alt1_same_alt2","1"],["all","raw","all","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["all","raw","all","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["all","raw","all","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["all","raw","all","same_pos_diff_ref_same_alt","1"],["all","raw","all","same_pos_same_ref_diff_alt","1"],["all","raw","all","same_pos_same_ref_same_alt","1"],["all","raw","all","overlapping_position","1"],["all","raw","all","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["all","raw","all","same_pos_same_ref_same_alt1_diff_alt2","1"],["all","raw","all","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["all","raw","all","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["all","raw","sample1","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["all","raw","sample1","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["all","raw","sample1","diff_pos_same_ref_same_alt","1"],["all","raw","sample1","same_pos_same_ref_same_alt1_same_alt2","1"],["all","raw","sample1","same_pos_same_ref_diff_alt1_same_alt2","1"],["all","raw","sample1","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["all","raw","sample1","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["all","raw","sample1","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["all","raw","sample1","same_pos_diff_ref_same_alt","1"],["all","raw","sample1","same_pos_same_ref_diff_alt","1"],["all","raw","sample1","same_pos_same_ref_same_alt","1"],["all","raw","sample1","overlapping_position","1"],["all","raw","sample1","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["all","raw","sample1","same_pos_same_ref_same_alt1_diff_alt2","1"],["all","raw","sample1","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["all","raw","sample1","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["all","raw","sample2","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["all","raw","sample2","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["all","raw","sample2","diff_pos_same_ref_same_alt","1"],["all","raw","sample2","same_pos_same_ref_same_alt1_same_alt2","1"],["all","raw","sample2","same_pos_same_ref_diff_alt1_same_alt2","1"],["all","raw","sample2","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["all","raw","sample2","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["all","raw","sample2","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["all","raw","sample2","same_pos_diff_ref_same_alt","1"],["all","raw","sample2","same_pos_same_ref_diff_alt","1"],["all","raw","sample2","same_pos_same_ref_same_alt","1"],["all","raw","sample2","overlapping_position","1"],["all","raw","sample2","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["all","raw","sample2","same_pos_same_ref_same_alt1_diff_alt2","1"],["all","raw","sample2","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["all","raw","sample2","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"]],"columns":[{"name":"Contig","label":"Contig"},{"name":"Filter","label":"Filter"},{"name":"Sample","label":"Sample"},{"name":"Value","label":"Value"},{"name":"Count","label":"Count"}]}},{"label":"Sites By Filter","data":{"plot_type":"data_table","samples":["1","2"],"datasets":[["1",4],["2",0]],"columns":[{"name":"Contig","label":"Contig"},{"name":"PASS","label":"PASS","formatString":"0,0","flagAbove":7.656854249492381,"flagBelow":-3.6568542494923806,"dmin":0.0,"dmax":4.4}]}},{"label":"Filter Type","data":{"plot_type":"bar_graph","samples":[["1","2"]],"datasets":[[{"name":"PASS","data":[4,0]}]],"config":{"ylab":"# Variants","title":"Filter Type"}}}]},{"label":"By Sample","reports":[{"label":"Variant Summary","data":{"plot_type":"data_table","samples":["called / all","called / sample1","called / sample2","filtered / all","filtered / sample1","filtered / sample2","raw / all","raw / sample1","raw / sample2"],"datasets":[["called","all",16000,16,12,4,2.5E-4,4000.0,3,0,1,0,0,0,0,12,4,16,0,3,0,2.5E-4,4000.0,4.0,6.25E-5,16000.0,1.0],["called","sample1",16000,16,15,1,6.25E-5,16000.0,1,0,0,0,0,0,0,7,1,8,0,1,0,6.25E-5,16000.0,1.0,0.0,0.0,0.0],["called","sample2",16000,16,13,3,1.875E-4,5333.0,2,0,1,0,0,0,0,5,3,8,0,2,0,1.88E-4,5333.0,3.0,6.25E-5,16000.0,1.0],["filtered","all",16000,0,0,0,0.0,0.0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,0.0,0.0],["filtered","sample1",16000,0,0,0,0.0,0.0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,0.0,0.0],["filtered","sample2",16000,0,0,0,0.0,0.0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,0.0,0.0],["raw","all",16000,16,12,4,2.5E-4,4000.0,3,0,1,0,0,0,0,12,4,16,0,3,0,2.5E-4,4000.0,4.0,6.25E-5,16000.0,1.0],["raw","sample1",16000,16,15,1,6.25E-5,16000.0,1,0,0,0,0,0,0,7,1,8,0,1,0,6.25E-5,16000.0,1.0,0.0,0.0,0.0],["raw","sample2",16000,16,13,3,1.875E-4,5333.0,2,0,1,0,0,0,0,5,3,8,0,2,0,1.88E-4,5333.0,3.0,6.25E-5,16000.0,1.0]],"columns":[{"name":"Filter","label":"Filter"},{"name":"Sample","label":"Sample"},{"name":"nProcessedLoci","label":"nProcessedLoci","formatString":"0,0","flagAbove":16000.0,"flagBelow":16000.0,"dmin":14400.0,"dmax":17600.0},{"name":"nCalledLoci","label":"nCalledLoci","formatString":"0,0","flagAbove":26.666666666666664,"flagBelow":-5.333333333333334,"dmin":0.0,"dmax":17.6},{"name":"nRefLoci","label":"nRefLoci","formatString":"0,0","flagAbove":22.39608861512543,"flagBelow":-4.61831083734765,"dmin":0.0,"dmax":16.5},{"name":"nVariantLoci","label":"nVariantLoci","formatString":"0,0","flagAbove":5.20965449144011,"flagBelow":-1.6540989358845555,"dmin":0.0,"dmax":4.4},{"name":"variantRate","label":"variantRate","flagAbove":3.25603405715007E-4,"flagBelow":-1.0338118349278473E-4,"dmin":0.0,"dmax":2.750000130617991E-4},{"name":"variantRatePerBp","label":"variantRatePerBp","flagAbove":18192.491442963048,"flagBelow":-6933.380331851938,"dmin":0.0,"dmax":17600.0},{"name":"nSNPs","label":"nSNPs","formatString":"0,0","flagAbove":3.782823076116512,"flagBelow":-1.116156409449845,"dmin":0.0,"dmax":3.3},{"name":"nMNPs","label":"nMNPs","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nInsertions","label":"nInsertions","formatString":"0,0","flagAbove":1.4985369978339043,"flagBelow":-0.6096481089450154,"dmin":0.0,"dmax":1.1},{"name":"nDeletions","label":"nDeletions","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nComplex","label":"nComplex","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nSymbolic","label":"nSymbolic","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nMixed","label":"nMixed","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nNoCalls","label":"nNoCalls","formatString":"0,0","flagAbove":14.82016631383847,"flagBelow":-4.153499647171805,"dmin":0.0,"dmax":13.2},{"name":"nHets","label":"nHets","formatString":"0,0","flagAbove":5.20965449144011,"flagBelow":-1.6540989358845555,"dmin":0.0,"dmax":4.4},{"name":"nHomRef","label":"nHomRef","formatString":"0,0","flagAbove":19.618886470640255,"flagBelow":-5.396664248418036,"dmin":0.0,"dmax":17.6},{"name":"nHomVar","label":"nHomVar","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nSingletons","label":"nSingletons","formatString":"0,0","flagAbove":3.782823076116512,"flagBelow":-1.116156409449845,"dmin":0.0,"dmax":3.3},{"name":"nHomDerived","label":"nHomDerived","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"heterozygosity","label":"heterozygosity","flagAbove":3.258929649371478E-4,"flagBelow":-1.0344852049270337E-4,"dmin":0.0,"dmax":2.750000130617991E-4},{"name":"heterozygosityPerBp","label":"heterozygosityPerBp","flagAbove":18192.491442963048,"flagBelow":-6933.380331851938,"dmin":0.0,"dmax":17600.0},{"name":"hetHomRatio","label":"hetHomRatio","flagAbove":5.20965449144011,"flagBelow":-1.6540989358845555,"dmin":0.0,"dmax":4.4},{"name":"indelRate","label":"indelRate","flagAbove":9.365856236461903E-5,"flagBelow":-3.810300680906346E-5,"dmin":0.0,"dmax":6.875000326544978E-5},{"name":"indelRatePerBp","label":"indelRatePerBp","flagAbove":23976.591965342464,"flagBelow":-9754.369743120244,"dmin":0.0,"dmax":17600.0},{"name":"insertionDeletionRatio","label":"insertionDeletionRatio","flagAbove":1.4985369978339043,"flagBelow":-0.6096481089450154,"dmin":0.0,"dmax":1.1}]}},{"label":"Variant Type","data":{"plot_type":"bar_graph","samples":[["called / all","called / sample1","called / sample2","filtered / all","filtered / sample1","filtered / sample2","raw / all","raw / sample1","raw / sample2"]],"datasets":[[{"name":"nSNPs","data":[3,1,2,0,0,0,3,1,2]},{"name":"nMNPs","data":[0,0,0,0,0,0,0,0,0]},{"name":"nInsertions","data":[1,0,1,0,0,0,1,0,1]},{"name":"nDeletions","data":[0,0,0,0,0,0,0,0,0]},{"name":"nComplex","data":[0,0,0,0,0,0,0,0,0]},{"name":"nSymbolic","data":[0,0,0,0,0,0,0,0,0]},{"name":"nMixed","data":[0,0,0,0,0,0,0,0,0]}]],"config":{"ylab":"# Variants","title":"Variant Type"}}},{"label":"Genotype Summary","data":{"plot_type":"data_table","samples":["called / all","called / sample1","called / sample2","filtered / all","filtered / sample1","filtered / sample2","raw / all","raw / sample1","raw / sample2"],"datasets":[["called","all",20,12],["called","sample1",9,7],["called","sample2",11,5],["filtered","all",0,0],["filtered","sample1",0,0],["filtered","sample2",0,0],["raw","all",20,12],["raw","sample1",9,7],["raw","sample2",11,5]],"columns":[{"name":"Filter","label":"Filter"},{"name":"Sample","label":"Sample"},{"name":"nCalledNotFiltered","label":"nCalledNotFiltered","formatString":"0,0","flagAbove":24.58743800797771,"flagBelow":-6.809660230199933,"dmin":0.0,"dmax":22.0},{"name":"nNoCallOrFiltered","label":"nNoCallOrFiltered","formatString":"0,0","flagAbove":14.82016631383847,"flagBelow":-4.153499647171805,"dmin":0.0,"dmax":13.2}]}},{"label":"SNP/Indel Summary","data":{"plot_type":"data_table","samples":["called / all","called / sample1","called / sample2","filtered / all","filtered / sample1","filtered / sample2","raw / all","raw / sample1","raw / sample2"],"datasets":[["called","all",3,3,1,1,"0","0.00","3.00","3.00",1,"100.00","1","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["called","sample1",1,1,0,0,"0","NA","NA","NA",0,"NA","0","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["called","sample2",2,2,1,1,"0","0.00","2.00","2.00",1,"100.00","1","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["filtered","all",0,0,0,0,"0","NA","NA","NA",0,"NA","0","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["filtered","sample1",0,0,0,0,"0","NA","NA","NA",0,"NA","0","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["filtered","sample2",0,0,0,0,"0","NA","NA","NA",0,"NA","0","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["raw","all",3,3,1,1,"0","0.00","3.00","3.00",1,"100.00","1","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["raw","sample1",1,1,0,0,"0","NA","NA","NA",0,"NA","0","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"],["raw","sample2",2,2,1,1,"0","0.00","2.00","2.00",1,"100.00","1","0","NA","0","0","NA","0","0","NA","NA","NA","NA","NA"]],"columns":[{"name":"Filter","label":"Filter"},{"name":"Sample","label":"Sample"},{"name":"n_SNPs","label":"n_SNPs","formatString":"0,0","flagAbove":3.782823076116512,"flagBelow":-1.116156409449845,"dmin":0.0,"dmax":3.3},{"name":"n_singleton_SNPs","label":"n_singleton_SNPs","formatString":"0,0","flagAbove":3.782823076116512,"flagBelow":-1.116156409449845,"dmin":0.0,"dmax":3.3},{"name":"n_indels","label":"n_indels","formatString":"0,0","flagAbove":1.4985369978339043,"flagBelow":-0.6096481089450154,"dmin":0.0,"dmax":1.1},{"name":"n_singleton_indels","label":"n_singleton_indels","formatString":"0,0","flagAbove":1.4985369978339043,"flagBelow":-0.6096481089450154,"dmin":0.0,"dmax":1.1},{"name":"n_multiallelic_indel_sites","label":"n_multiallelic_indel_sites"},{"name":"percent_of_sites_with_more_than_2_alleles","label":"percent_of_sites_with_more_than_2_alleles"},{"name":"SNP_to_indel_ratio","label":"SNP_to_indel_ratio"},{"name":"SNP_to_indel_ratio_for_singletons","label":"SNP_to_indel_ratio_for_singletons"},{"name":"n_novel_indels","label":"n_novel_indels","formatString":"0,0","flagAbove":1.4985369978339043,"flagBelow":-0.6096481089450154,"dmin":0.0,"dmax":1.1},{"name":"indel_novelty_rate","label":"indel_novelty_rate"},{"name":"n_insertions","label":"n_insertions"},{"name":"n_deletions","label":"n_deletions"},{"name":"insertion_to_deletion_ratio","label":"insertion_to_deletion_ratio"},{"name":"n_large_deletions","label":"n_large_deletions"},{"name":"n_large_insertions","label":"n_large_insertions"},{"name":"insertion_to_deletion_ratio_for_large_indels","label":"insertion_to_deletion_ratio_for_large_indels"},{"name":"n_coding_indels_frameshifting","label":"n_coding_indels_frameshifting"},{"name":"n_coding_indels_in_frame","label":"n_coding_indels_in_frame"},{"name":"frameshift_rate_for_coding_indels","label":"frameshift_rate_for_coding_indels"},{"name":"SNP_het_to_hom_ratio","label":"SNP_het_to_hom_ratio"},{"name":"indel_het_to_hom_ratio","label":"indel_het_to_hom_ratio"},{"name":"ratio_of_1_and_2_to_3_bp_insertions","label":"ratio_of_1_and_2_to_3_bp_insertions"},{"name":"ratio_of_1_and_2_to_3_bp_deletions","label":"ratio_of_1_and_2_to_3_bp_deletions"}]}},{"label":"Purpose Report","data":{"plot_type":"data_table","samples":["called / all","called / sample1","called / sample2","filtered / all","filtered / sample1","filtered / sample2","raw / all","raw / sample1","raw / sample2"],"datasets":[["called","all","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["called","all","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["called","all","diff_pos_same_ref_same_alt","1"],["called","all","same_pos_same_ref_same_alt1_same_alt2","1"],["called","all","same_pos_same_ref_diff_alt1_same_alt2","1"],["called","all","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["called","all","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["called","all","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["called","all","same_pos_diff_ref_same_alt","1"],["called","all","same_pos_same_ref_diff_alt","1"],["called","all","same_pos_same_ref_same_alt","1"],["called","all","overlapping_position","1"],["called","all","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["called","all","same_pos_same_ref_same_alt1_diff_alt2","1"],["called","all","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["called","all","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["called","sample1","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["called","sample1","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["called","sample1","diff_pos_same_ref_same_alt","1"],["called","sample1","same_pos_same_ref_same_alt1_same_alt2","1"],["called","sample1","same_pos_same_ref_diff_alt1_same_alt2","1"],["called","sample1","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["called","sample1","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["called","sample1","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["called","sample1","same_pos_diff_ref_same_alt","1"],["called","sample1","same_pos_same_ref_diff_alt","1"],["called","sample1","same_pos_same_ref_same_alt","1"],["called","sample1","overlapping_position","1"],["called","sample1","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["called","sample1","same_pos_same_ref_same_alt1_diff_alt2","1"],["called","sample1","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["called","sample1","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["called","sample2","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["called","sample2","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["called","sample2","diff_pos_same_ref_same_alt","1"],["called","sample2","same_pos_same_ref_same_alt1_same_alt2","1"],["called","sample2","same_pos_same_ref_diff_alt1_same_alt2","1"],["called","sample2","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["called","sample2","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["called","sample2","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["called","sample2","same_pos_diff_ref_same_alt","1"],["called","sample2","same_pos_same_ref_diff_alt","1"],["called","sample2","same_pos_same_ref_same_alt","1"],["called","sample2","overlapping_position","1"],["called","sample2","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["called","sample2","same_pos_same_ref_same_alt1_diff_alt2","1"],["called","sample2","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["called","sample2","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["filtered","all","Empty/Blank","0"],["filtered","sample1","Empty/Blank","0"],["filtered","sample2","Empty/Blank","0"],["raw","all","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["raw","all","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["raw","all","diff_pos_same_ref_same_alt","1"],["raw","all","same_pos_same_ref_same_alt1_same_alt2","1"],["raw","all","same_pos_same_ref_diff_alt1_same_alt2","1"],["raw","all","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["raw","all","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["raw","all","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["raw","all","same_pos_diff_ref_same_alt","1"],["raw","all","same_pos_same_ref_diff_alt","1"],["raw","all","same_pos_same_ref_same_alt","1"],["raw","all","overlapping_position","1"],["raw","all","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["raw","all","same_pos_same_ref_same_alt1_diff_alt2","1"],["raw","all","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["raw","all","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["raw","sample1","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["raw","sample1","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["raw","sample1","diff_pos_same_ref_same_alt","1"],["raw","sample1","same_pos_same_ref_same_alt1_same_alt2","1"],["raw","sample1","same_pos_same_ref_diff_alt1_same_alt2","1"],["raw","sample1","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["raw","sample1","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["raw","sample1","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["raw","sample1","same_pos_diff_ref_same_alt","1"],["raw","sample1","same_pos_same_ref_diff_alt","1"],["raw","sample1","same_pos_same_ref_same_alt","1"],["raw","sample1","overlapping_position","1"],["raw","sample1","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["raw","sample1","same_pos_same_ref_same_alt1_diff_alt2","1"],["raw","sample1","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["raw","sample1","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"],["raw","sample2","same_pos_same_ref_same_alt1_same_alt2_diff_alt3","1"],["raw","sample2","same_pos_same_ref_same_alt1_diff_alt2_diff_alt3","1"],["raw","sample2","diff_pos_same_ref_same_alt","1"],["raw","sample2","same_pos_same_ref_same_alt1_same_alt2","1"],["raw","sample2","same_pos_same_ref_diff_alt1_same_alt2","1"],["raw","sample2","same_pos_same_ref_diff_alt1_same_alt2_diff_alt3","1"],["raw","sample2","same_pos_same_ref_diff_alt1_diff_alt2_diff_alt3","1"],["raw","sample2","same_pos_same_ref_same_alt1_diff_alt2_same_alt3","1"],["raw","sample2","same_pos_diff_ref_same_alt","1"],["raw","sample2","same_pos_same_ref_diff_alt","1"],["raw","sample2","same_pos_same_ref_same_alt","1"],["raw","sample2","overlapping_position","1"],["raw","sample2","same_pos_same_ref_diff_alt1_same_alt2_same_alt3","1"],["raw","sample2","same_pos_same_ref_same_alt1_diff_alt2","1"],["raw","sample2","same_pos_same_ref_diff_alt1_diff_alt2_same_alt3","1"],["raw","sample2","same_pos_same_ref_same_alt1_same_alt2_same_alt3","1"]],"columns":[{"name":"Filter","label":"Filter"},{"name":"Sample","label":"Sample"},{"name":"Value","label":"Value"},{"name":"Count","label":"Count"}]}},{"label":"Ti/Tv Data","data":{"plot_type":"data_table","samples":["called / all","called / sample1","called / sample2","filtered / all","filtered / sample1","filtered / sample2","raw / all","raw / sample1","raw / sample2"],"datasets":[["called","all",2,1,2.0,0,0,0.0,0,0,0.0],["called","sample1",0,1,0.0,0,0,0.0,0,0,0.0],["called","sample2",2,0,2.0,0,0,0.0,0,0,0.0],["filtered","all",0,0,0.0,0,0,0.0,0,0,0.0],["filtered","sample1",0,0,0.0,0,0,0.0,0,0,0.0],["filtered","sample2",0,0,0.0,0,0,0.0,0,0,0.0],["raw","all",2,1,2.0,0,0,0.0,0,0,0.0],["raw","sample1",0,1,0.0,0,0,0.0,0,0,0.0],["raw","sample2",2,0,2.0,0,0,0.0,0,0,0.0]],"columns":[{"name":"Filter","label":"Filter"},{"name":"Sample","label":"Sample"},{"name":"nTi","label":"nTi","formatString":"0,0","flagAbove":2.9970739956678085,"flagBelow":-1.2192962178900308,"dmin":0.0,"dmax":2.2},{"name":"nTv","label":"nTv","formatString":"0,0","flagAbove":1.4985369978339043,"flagBelow":-0.6096481089450154,"dmin":0.0,"dmax":1.1},{"name":"tiTvRatio","label":"tiTvRatio","flagAbove":2.9970739956678085,"flagBelow":-1.2192962178900308,"dmin":0.0,"dmax":2.2},{"name":"nTiInComp","label":"nTiInComp","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nTvInComp","label":"nTvInComp","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"TiTvRatioStandard","label":"TiTvRatioStandard","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nTiDerived","label":"nTiDerived","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nTvDerived","label":"nTvDerived","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"tiTvDerivedRatio","label":"tiTvDerivedRatio","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0}]}},{"label":"Sites By Filter","data":{"plot_type":"data_table","samples":["sample1","sample2"],"datasets":[["sample1",1],["sample2",3]],"columns":[{"name":"Sample","label":"Sample"},{"name":"PASS","label":"PASS","formatString":"0,0","flagAbove":4.82842712474619,"flagBelow":-0.8284271247461903,"dmin":0.9,"dmax":3.3}]}},{"label":"Filter Type","data":{"plot_type":"bar_graph","samples":[["sample1","sample2"]],"datasets":[[{"name":"PASS","data":[1,3]}]],"config":{"ylab":"# Variants","title":"Filter Type"}}},{"label":"Variants Per Contig","data":{"plot_type":"data_table","samples":["sample1","sample2"],"datasets":[["sample1","UNKNOWN",1,0,1],["sample2","UNKNOWN",3,0,3]],"columns":[{"name":"Sample","label":"Sample"},{"name":"Gender","label":"Gender"},{"name":"1","label":"1","formatString":"0,0","flagAbove":4.82842712474619,"flagBelow":-0.8284271247461903,"dmin":0.9,"dmax":3.3},{"name":"2","label":"2","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"all","label":"all","formatString":"0,0","flagAbove":4.82842712474619,"flagBelow":-0.8284271247461903,"dmin":0.9,"dmax":3.3}]}}]},{"label":"By Filter Type","reports":[{"label":"Variant Summary","data":{"plot_type":"data_table","samples":["called / PASS","filtered / PASS","raw / PASS"],"datasets":[["called","PASS",16000,16,12,4,2.5E-4,4000.0,3,0,1,0,0,0,0,12,4,16,0,3,0,2.5E-4,4000.0,4.0,6.25E-5,16000.0,1.0],["filtered","PASS",16000,0,0,0,0.0,0.0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,0.0,0.0],["raw","PASS",16000,16,12,4,2.5E-4,4000.0,3,0,1,0,0,0,0,12,4,16,0,3,0,2.5E-4,4000.0,4.0,6.25E-5,16000.0,1.0]],"columns":[{"name":"Filter","label":"Filter"},{"name":"FilterType","label":"FilterType"},{"name":"nProcessedLoci","label":"nProcessedLoci","formatString":"0,0","flagAbove":16000.0,"flagBelow":16000.0,"dmin":14400.0,"dmax":17600.0},{"name":"nCalledLoci","label":"nCalledLoci","formatString":"0,0","flagAbove":29.141875280734695,"flagBelow":-7.808541947401361,"dmin":0.0,"dmax":17.6},{"name":"nRefLoci","label":"nRefLoci","formatString":"0,0","flagAbove":21.856406460551018,"flagBelow":-5.8564064605510175,"dmin":0.0,"dmax":13.2},{"name":"nVariantLoci","label":"nVariantLoci","formatString":"0,0","flagAbove":7.285468820183674,"flagBelow":-1.9521354868503402,"dmin":0.0,"dmax":4.4},{"name":"variantRate","label":"variantRate","flagAbove":4.5534180126147953E-4,"flagBelow":-1.2200846792814624E-4,"dmin":0.0,"dmax":2.750000130617991E-4},{"name":"variantRatePerBp","label":"variantRatePerBp","flagAbove":7285.4688201836725,"flagBelow":-1952.135486850339,"dmin":0.0,"dmax":4400.0},{"name":"nSNPs","label":"nSNPs","formatString":"0,0","flagAbove":5.464101615137754,"flagBelow":-1.4641016151377544,"dmin":0.0,"dmax":3.3},{"name":"nMNPs","label":"nMNPs","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nInsertions","label":"nInsertions","formatString":"0,0","flagAbove":1.8213672050459184,"flagBelow":-0.48803387171258505,"dmin":0.0,"dmax":1.1},{"name":"nDeletions","label":"nDeletions","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nComplex","label":"nComplex","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nSymbolic","label":"nSymbolic","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nMixed","label":"nMixed","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nNoCalls","label":"nNoCalls","formatString":"0,0","flagAbove":21.856406460551018,"flagBelow":-5.8564064605510175,"dmin":0.0,"dmax":13.2},{"name":"nHets","label":"nHets","formatString":"0,0","flagAbove":7.285468820183674,"flagBelow":-1.9521354868503402,"dmin":0.0,"dmax":4.4},{"name":"nHomRef","label":"nHomRef","formatString":"0,0","flagAbove":29.141875280734695,"flagBelow":-7.808541947401361,"dmin":0.0,"dmax":17.6},{"name":"nHomVar","label":"nHomVar","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"nSingletons","label":"nSingletons","formatString":"0,0","flagAbove":5.464101615137754,"flagBelow":-1.4641016151377544,"dmin":0.0,"dmax":3.3},{"name":"nHomDerived","label":"nHomDerived","formatString":"0,0","flagAbove":0.0,"flagBelow":0.0,"dmin":0.0,"dmax":1.0},{"name":"heterozygosity","label":"heterozygosity","flagAbove":4.5534180126147953E-4,"flagBelow":-1.2200846792814624E-4,"dmin":0.0,"dmax":2.750000130617991E-4},{"name":"heterozygosityPerBp","label":"heterozygosityPerBp","flagAbove":7285.4688201836725,"flagBelow":-1952.135486850339,"dmin":0.0,"dmax":4400.0},{"name":"hetHomRatio","label":"hetHomRatio","flagAbove":7.285468820183674,"flagBelow":-1.9521354868503402,"dmin":0.0,"dmax":4.4},{"name":"indelRate","label":"indelRate","flagAbove":1.1383545031536988E-4,"flagBelow":-3.050211698203656E-5,"dmin":0.0,"dmax":6.875000326544978E-5},{"name":"indelRatePerBp","label":"indelRatePerBp","flagAbove":29141.87528073469,"flagBelow":-7808.541947401356,"dmin":0.0,"dmax":17600.0},{"name":"insertionDeletionRatio","label":"insertionDeletionRatio","flagAbove":1.8213672050459184,"flagBelow":-0.48803387171258505,"dmin":0.0,"dmax":1.1}]}},{"label":"Variant Type","data":{"plot_type":"bar_graph","samples":[["called / PASS","filtered / PASS","raw / PASS"]],"datasets":[[{"name":"nSNPs","data":[3,0,3]},{"name":"nMNPs","data":[0,0,0]},{"name":"nInsertions","data":[1,0,1]},{"name":"nDeletions","data":[0,0,0]},{"name":"nComplex","data":[0,0,0]},{"name":"nSymbolic","data":[0,0,0]},{"name":"nMixed","data":[0,0,0]}]],"config":{"ylab":"# Variants","title":"Variant Type"}}}]}]
});
});
</script>
<script type="text/javascript">
////////////////////////////////////////////////
// MultiQC Table code
////////////////////////////////////////////////

var brewer_scales = ['YlOrRd', 'YlOrBr', 'YlGnBu', 'YlGn', 'Reds', 'RdPu',
    'Purples', 'PuRd', 'PuBuGn', 'PuBu', 'OrRd', 'Oranges', 'Greys', 'Greens',
    'GnBu', 'BuPu', 'BuGn', 'Blues', 'Set3', 'Set2', 'Set1', 'Pastel2', 'Pastel1',
    'Paired', 'Dark2', 'Accent', 'Spectral', 'RdYlGn', 'RdYlBu', 'RdGy', 'RdBu',
    'PuOr', 'PRGn', 'PiYG', 'BrBG'];


// TOOLBOX LISTENERS

// Update tablesorter if samples renamed
$(document).on('mqc_renamesamples', function(e, f_texts, t_texts, regex_mode){
    $('.mqc_table').trigger('update');
});

// highlight samples
$(document).on('mqc_highlights', function(e, f_texts, f_cols, regex_mode){
    $('.mqc_table_sortHighlight').hide();
    $('.mqc_table tbody th').removeClass('highlighted').removeData('highlight');
    $('.mqc_table tbody th').each(function(i){
        var th = $(this);
        var thtext = $(this).text();
        var thiscol = '#333';
        $.each(f_texts, function(idx, f_text){
            if((regex_mode && thtext.match(f_text)) || (!regex_mode && thtext.indexOf(f_text) > -1)){
                thiscol = f_cols[idx];
                th.addClass('highlighted').data('highlight', idx);
                $('.mqc_table_sortHighlight').show();
            }
        });
        $(this).css('color', thiscol);
    });
});

// Rename samples
$(document).on('mqc_renamesamples', function(e, f_texts, t_texts, regex_mode){
    $(".mqc_table tbody th").each(function(){
        var s_name = $(this).data('original-sn');
        $.each(f_texts, function(idx, f_text){
            if(regex_mode){
                var re = new RegExp(f_text,"g");
                s_name = s_name.replace(re, t_texts[idx]);
            } else {
                s_name = s_name.replace(f_text, t_texts[idx]);
            }
        });
        $(this).text(s_name);
    });
});

// Hide samples
$(document).on('mqc_hidesamples', function(e, f_texts, regex_mode){
    // Hide rows in MultiQC tables
    $(".mqc_table tbody th").each(function(){
        var match = false;
        var hfilter = $(this).text();
        $.each(f_texts, function(idx, f_text){
            if((regex_mode && hfilter.match(f_text)) || (!regex_mode && hfilter.indexOf(f_text) > -1)){
                match = true;
            }
        });
        if(window.mqc_hide_mode == 'show'){
            match = !match;
        }
        if(match){
            $(this).parent().hide().addClass('hidden');
        } else {
            $(this).parent().show().removeClass('hidden');
        }
    });
    $('.mqc_table_numrows').each(function(){
        var tid = $(this).attr('id').replace('_numrows','');
        $(this).text( $('#'+tid+' tbody tr:visible').length );
    });

    // Hide empty columns
    $('.mqc_table').each(function(){
        var table = $(this);
        var gsthidx = 0;
        table.find("thead th, tbody tr td").show();
        table.find("thead th").each(function(){
            if(gsthidx == 0){ gsthidx += 1; return true; }
            var count = 0;
            var empties = 0;
            table.find("tbody tr td:nth-child("+(gsthidx+2)+")").filter(":visible").each(function(){
                count += 1;
                if($(this).text() == ''){ empties += 1; }
            });
            if(count > 0 && count == empties){
                $(this).hide();
                table.find("tbody tr td:nth-child("+(gsthidx+2)+")").hide();
            }
            gsthidx += 1;
        });
    });
    $('.mqc_table_numcols').each(function(){
        var tid = $(this).attr('id').replace('_numcols','');
        $(this).text( $('#'+tid+' thead th:visible').length - 1 );
    });
});

// Execute when page load has finished loading
function render_tables() {

    if($('.mqc_table').length > 0){

        // Enable tablesorter on MultiQC tables
        $('.mqc_table').tablesorter({
            sortInitialOrder: 'desc',
            textExtraction: function(node){
                //replace non-alphanumeric characters for proper sorting
                return $(node).text().replace(new RegExp(/[^0-9A-Za-z ]/g),"");
            }
        });

        // Copy table contents to clipboard
        var clipboard = new Clipboard('.mqc_table_copy_btn');
        clipboard.on('success', function(e) { e.clearSelection(); });
        $('.mqc_table_copy_btn').click(function(){
            var btn = $(this);
            btn.addClass('active').html('<span class="glyphicon glyphicon-copy"></span> Copied!');
            setTimeout(function(){
                btn.removeClass('active').html('<span class="glyphicon glyphicon-copy"></span> Copy table');
            }, 2000);
        });

        // Make table headers fixed when table body scrolls (use CSS transforms)
        // http://stackoverflow.com/a/25902860/713980
        $('.mqc-table-responsive').scroll(function() {
            $(this).find('thead').css('transform', "translate(0,"+$(this).scrollTop()+"px)");
        });

        // Expand tables to full height
        $('.mqc-table-expand').click(function(){
            if($(this).find('span').hasClass('glyphicon-chevron-down')){
                $(this).parent().find('.mqc-table-responsive').css('max-height', 'none');
                $(this).find('span').removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');
            } else {
                $(this).parent().find('.mqc-table-responsive').css('max-height', '400px');
                $(this).find('span').removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-down');
            }
        });

        // Colour code table cells using chroma.js
        $('.mqc_table').each(function(){
            var table = $(this);
            table.find('thead th').each(function(idx){
                if($(this).hasClass('chroma-col')){

                    // Get the colour scheme if set
                    var colscheme_rev = false;
                    var colscheme = $(this).data('chroma-scale');
                    if(colscheme.substr(colscheme.length - 4) == '-rev'){
                        colscheme_rev = true;
                        colscheme = colscheme.substr(0, colscheme.length - 4);
                    }
                    if(colscheme === undefined || brewer_scales.indexOf(colscheme) ==1){
                        colscheme = 'GnBu';
                    }

                    // Get the max and min values from data attributes
                    var maxval = $(this).data('chroma-max');
                    var minval = $(this).data('chroma-min');
                    if(isNaN(minval) || isNaN(maxval)){
                        console.log('Could not find max or min value for '+$(this).text()+': ['+[minval, maxval]+']')
                        return true; // Skip to next loop
                    }

                    // Go through table cells again, adding colour
                    var i = 0;
                    var scale = chroma.scale(colscheme).domain([minval, maxval]);
                    if(colscheme_rev){
                        scale = chroma.scale(colscheme).domain([maxval, minval]);
                    }
                    table.find('tr td:nth-of-type('+idx+')').each(function(){
                        var val = parseFloat($(this).text());
                        var rgb = scale(val).rgb(); //.luminance(0.7).css();
                        for (i in rgb){
                            rgb[i] = 255+(rgb[i]-255)*0.3;
                            if(rgb[i] > 255){ rgb[i] = 255; }
                            if(rgb[i] < 0){ rgb[i] = 0; }
                        }
                        var col = chroma.rgb(rgb).hex();
                        $(this).find('.wrapper .bar').css('background-color', col);
                    });

                }
            });
        });

        /////// COLUMN CONFIG
        // show + hide columns
        $('.mqc_table_col_visible').change(function(){
            var target = $(this).data('target');
            mqc_table_col_updateVisible(target);
        });
        // Bulk set visible / hidden
        $('.mqc_configModal_bulkVisible').click(function(e){
            e.preventDefault();
            var target = $(this).data('target');
            var visible = $(this).data('action') == 'showAll';
            $(target+'_configModal_table tbody .mqc_table_col_visible').prop('checked', visible);
            mqc_table_col_updateVisible(target);
        });
        function mqc_table_col_updateVisible(target){
            $(target+'_configModal_table .mqc_table_col_visible').each(function(){
                var cclass = $(this).val();
                if($(this).is(":checked")) {
                    $(target+' .'+cclass).removeClass('hidden');
                    $(target+'_configModal_table .'+cclass).removeClass('text-muted');
                } else {
                    $(target+' .'+cclass).addClass('hidden');
                    $(target+'_configModal_table .'+cclass).addClass('text-muted');
                }
            });
            // Hide empty rows
            $(target+' tbody tr').show();
            $(target+' tbody tr').each(function(){
                var hasVal = false;
                $(this).find('td:visible').each(function(){
                    if(!$(this).hasClass('sorthandle') && $(this).text() !== ''){
                        hasVal = true;
                    }
                });
                if(!hasVal){
                    $(this).hide();
                }
            });
            // Update counts
            $(target+'_numrows').text( $(target+' tbody tr:visible').length );
            $(target+'_numcols').text( $(target+' thead th:visible').length - 1 );
        }

        // Make rows in MultiQC tables sortable
        $('.mqc_table.mqc_sortable tbody').sortable({
            handle: '.sorthandle',
            helper: function fixWidthHelper(e, ui) {
                ui.children().each(function() { $(this).width($(this).width()); });
                return ui;
            }
        });

        // Change order of columns
        $('.mqc_configModal_table').on('sortstop', function(e, ui){
            change_mqc_table_col_order( $(this) );
        });
        $('.mqc_configModal_table').bind('sortEnd',function() {
            change_mqc_table_col_order( $(this) );
        });

        // Sort MultiQC tables by highlight
        $('.mqc_table_sortHighlight').click(function(e){
            e.preventDefault();
            var target = $(this).data('target');
            // collect highlighted rows
            var hrows = $(target+' tbody th.highlighted').parent().detach();
            hrows = hrows.sort(function (a, b) {
                return $(a).find('th').data('highlight') - $(b).find('th').data('highlight');
            });
            if($(this).data('direction') == 'desc'){
                hrows = hrows.get().reverse();
                $(target+' tbody').prepend(hrows);
                $(this).data('direction', 'asc');
            } else {
                $(target+' tbody').append(hrows);
                $(this).data('direction', 'desc');
            }
        });

    } // End of check for table

    // Table Scatter Modal
    $('#tableScatterForm').submit(function(e){
        e.preventDefault();
    });
    $('.mqc_table_makeScatter').click(function(e){
        // Reset dropdowns
        if($('#tableScatter_tid').val() != $(this).data('table')){
            $('#tableScatter_col1, #tableScatter_col2').html('<option value="">Select Column</option>');
            // Add columns to dropdowns
            $($(this).data('table')+' thead tr th').each(function(e){
                var c_id = $(this).attr('id');
                if(c_id != undefined){
                    var c_name = $(this).attr('data-namespace') + ': ' + $(this).text();
                    $('#tableScatter_col1, #tableScatter_col2').append('<option value="'+c_id+'">'+c_name+'</select>');
                }
            });
            $('#tableScatter_tid').val($(this).data('table'));
            $('#tableScatterPlot').html('<small>Please select one or two table columns.</small>').addClass('not_rendered');
        }
    });
    $('#tableScatterForm select').change(function(e){
        var tid = $('#tableScatter_tid').val();
        var col1 = $('#tableScatter_col1').val().replace('header_', '');
        var col2 = $('#tableScatter_col2').val().replace('header_', '');

        if (!col1 && !col2) {
            $('#tableScatterPlot').html('<small>Please select two table columns.</small>');
            $('#tableScatterPlot').addClass('not_rendered');
        }
        else if (col2) {
            var col1_name = $('#tableScatter_col1 option:selected').text();
            var col2_name = $('#tableScatter_col2 option:selected').text();
            var col1_max = parseFloat($(tid + ' thead th#header_' + col1).data('dmax'));
            var col1_min = parseFloat($(tid + ' thead th#header_' + col1).data('dmin'));
            var col2_max = parseFloat($(tid + ' thead th#header_' + col2).data('dmax'));
            var col2_min = parseFloat($(tid + ' thead th#header_' + col2).data('dmin'));
            if (isNaN(col1_max)) {
                col1_max = undefined;
            }
            if (isNaN(col1_min)) {
                col1_min = undefined;
            }
            if (isNaN(col2_max)) {
                col2_max = undefined;
            }
            if (isNaN(col2_min)) {
                col2_min = undefined;
            }
            if (col1 != '' && col2 != '') {
                $('#tableScatterPlot').html('<small>loading..</small>');
                if ($(tid).attr('data-title')) {
                    plot_title = $(tid).attr('data-title');
                } else {
                    plot_title = tid.replace(/^#/, '').replace(/_/g, ' ');
                }
                // Get the data values
                mqc_plots['tableScatterPlot'] = {
                    'plot_type': 'scatter',
                    'config': {
                        'id': 'tableScatter_' + tid,
                        'title': plot_title,
                        'xlab': col1_name,
                        'ylab': col2_name,
                        'xmin': col1_min,
                        'xmax': col1_max,
                        'ymin': col2_min,
                        'ymax': col2_max,
                    },
                    'datasets': [[]]
                };
                $(tid + ' tbody tr').each(function (e) {
                    var s_name = $(this).children('th.rowheader').text();
                    var val_1 = $(this).children('td.' + col1).text().replace(/[^\d\.]/g, '');
                    var val_2 = $(this).children('td.' + col2).text().replace(/[^\d\.]/g, '');
                    if (!isNaN(parseFloat(val_1)) && isFinite(val_1) && !isNaN(parseFloat(val_2)) && isFinite(val_2)) {
                        mqc_plots['tableScatterPlot']['datasets'][0].push({
                            'name': s_name,
                            'x': parseFloat(val_1),
                            'y': parseFloat(val_2)
                        });
                    }
                });
                if (Object.keys(mqc_plots['tableScatterPlot']['datasets'][0]).length > 0) {
                    if (plot_scatter_plot('tableScatterPlot') == false) {
                        $('#tableScatterPlot').html('<small>Error: Something went wrong when plotting the scatter plot.</small>');
                        $('#tableScatterPlot').addClass('not_rendered');
                    } else {
                        $('#tableScatterPlot').removeClass('not_rendered');
                    }
                } else {
                    $('#tableScatterPlot').html('<small>Error: No data pairs found for these columns.</small>');
                    $('#tableScatterPlot').addClass('not_rendered');
                }
            }
        }
        else {
            var col1_name = $('#tableScatter_col1 option:selected').text();
            var col1_max = parseFloat($(tid + ' thead th#header_' + col1).data('dmax'));
            var col1_min = parseFloat($(tid + ' thead th#header_' + col1).data('dmin'));
            if (isNaN(col1_max)) {
                col1_max = undefined;
            }
            if (isNaN(col1_min)) {
                col1_min = undefined;
            }
            if (col1 != '') {
                $('#tableScatterPlot').html('<small>loading..</small>');
                if ($(tid).attr('data-title')) {
                    plot_title = $(tid).attr('data-title');
                } else {
                    plot_title = tid.replace(/^#/, '').replace(/_/g, ' ');
                }
                // Get the data values
                mqc_plots['tableScatterPlot'] = {
                    'plot_type': 'histogram',
                    'config': {
                        'id': 'tableScatter_' + tid,
                        'title': plot_title,
                        'xlab': col1_name,
                        'xmin': col1_min,
                        'xmax': col1_max
                    },
                    'datasets': [[]]
                };
                $(tid + ' tbody tr').each(function (e) {
                    var s_name = $(this).children('th.rowheader').text();
                    var val_1 = $(this).children('td.' + col1).text().replace(/[^\d\.]/g, '');
                    if (!isNaN(parseFloat(val_1)) && isFinite(val_1)) {
                        mqc_plots['tableScatterPlot']['datasets'][0].push({
                            'name': s_name,
                            'x': parseFloat(val_1)
                        });
                    }
                });
                if (Object.keys(mqc_plots['tableScatterPlot']['datasets'][0]).length > 0) {
                    if (plot_histogram('tableScatterPlot') == false) {
                        $('#tableScatterPlot').html('<small>Error: Something went wrong when plotting the histogram.</small>');
                        $('#tableScatterPlot').addClass('not_rendered');
                    } else {
                        $('#tableScatterPlot').removeClass('not_rendered');
                    }
                } else {
                    $('#tableScatterPlot').html('<small>Error: No data pairs found for this column.</small>');
                    $('#tableScatterPlot').addClass('not_rendered');
                }
            }
        }
    });

};

// Reorder columns in MultiQC tables.
// Note: Don't have to worry about floating headers, as 'Configure Columns'
// button is only visible when this is hidden. Ace!
function change_mqc_table_col_order(table){

    // Find the targets of this sorting
    var tid = table.attr('id');
    var target = tid.replace('_configModal_table','');

    // Collect the desired order of columns
    var classes = [];
    $('#'+tid+' tbody tr').each(function(){
        classes.push($(this).attr('class'));
    });
    // Go through each row
    $('#'+target+' tr').each(function(){
        var cols = {};
        var row = $(this);
        // Detach any cell that matches a known class from above
        row.find('td, th').each(function(){
            var cell = $(this);
            $.each(classes, function(idx, c){
                if(cell.hasClass(c)){
                    cols[c] = cell.detach();
                }
            });
        });
        // Insert detached cells back in the order given in the sorted table
        for (var idx in classes){
            var c = classes[idx];
            if(cols[c] !== undefined){
                row.append(cols[c]);
            }
        }
    });
}
</script>
<script type="text/javascript">
////////////////////////////////////////////////
// MultiQC Report Toolbox Code
////////////////////////////////////////////////

var mqc_colours_idx = 0;
var mqc_colours = ['#e41a1c', '#377eb8', '#4daf4a', '#984ea3', '#ff7f00', '#ffff33', '#a65628', '#f781bf', '#999999'];

//////////////////////////////////////////////////////
// TOOLBOX LISTENERS
//////////////////////////////////////////////////////
$(function () {
    // Hide toolbox when clicking outside
    $(document).mouseup(function (e) {
        if (!$(".mqc-toolbox").is(e.target) && $(".mqc-toolbox").has(e.target).length === 0) {
            mqc_toolbox_openclose(undefined, false);
        }
    });

    // Hide toolbox when a modal is shown
    $('.modal').on('show.bs.modal', function (e) {
        mqc_toolbox_openclose(undefined, false);
    });

    // Listener to re-plot graphs if config loaded
    $(document).on('mqc_config_loaded', function (e) {
        $('.hc-plot').each(function () {
            var target = $(this).attr('id');
            plot_graph(target, undefined, num_datasets_plot_limit);
        });
    });

    // Toolbox buttons
    $('.mqc-toolbox-buttons a').click(function (e) {
        e.preventDefault();
        var target = $(this).attr('href');
        mqc_toolbox_openclose(target);
    });

    // Rename samples
    var mqc_renamesamples_idx = 300;
    $('#mqc_renamesamples_form').submit(function (e) {
        e.preventDefault();
        var from_text = $('#mqc_renamesamples_from').val().trim();
        var to_text = $('#mqc_renamesamples_to').val().trim();
        if (from_text.length == 0) {
            alert('Error - "From" text must not be blank.');
            return false;
        }
        var li = '<li><input class="f_text from_text" value="' + from_text + '" tabindex="' + (mqc_renamesamples_idx) + '" />'
        li += '<small class="glyphicon glyphicon-chevron-right"></small><input class="f_text to_text" value="' + to_text + '" tabindex="' + (mqc_renamesamples_idx + 1) + '" />'
        li += '<button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button></li>'
        $('#mqc_renamesamples_filters').append(li);
        $('#mqc_rename_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary');
        $('#mqc_renamesamples_from').val('');
        $('#mqc_renamesamples_to').val('');
        mqc_renamesamples_idx += 2;
        $('#mqc_renamesamples_form input:first').focus();
    });
    $('#mqc_rename_apply').click(function (e) {
        apply_mqc_renamesamples();
        $(this).attr('disabled', true).removeClass('btn-primary').addClass('btn-default');
    });

    // Bulk rename samples
    $('#mqc_renamesamples_bulk_collapse').on('shown.bs.collapse', function () {
        $('#mqc_renamesamples_bulk_form textarea').focus();
    });
    $('#mqc_renamesamples_bulk_form').submit(function (e) {
        e.preventDefault();
        var raw = $(this).find('textarea').val();
        var lines = raw.match(/^.*([\n\r]+|$)/gm);
        $.each(lines, function (i, l) {
            var sections = l.split("\t", 2);
            if (sections.length < 2) {
                return true;
            }
            var from_text = sections[0].trim();
            var to_text = sections[1].trim();
            if (from_text.length == 0) {
                return true;
            }
            var li = '<li><input class="f_text from_text" value="' + from_text + '" tabindex="' + (mqc_renamesamples_idx) + '" />'
            li += '<small class="glyphicon glyphicon-chevron-right"></small><input class="f_text to_text" value="' + to_text + '" tabindex="' + (mqc_renamesamples_idx + 1) + '" />'
            li += '<button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button></li>'
            $('#mqc_renamesamples_filters').append(li);
        });
        $('#mqc_rename_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary');
        $(this).find('textarea').val('');
        $('#mqc_renamesamples_bulk_collapse').collapse('hide');
    });

    // Hide sample filters
    var mqc_hidesamples_idx = 200;
    $('#mqc_hidesamples_form').submit(function (e) {
        e.preventDefault();
        var f_text = $('#mqc_hidesamples_filter').val().trim();
        if (f_text.length == 0) {
            alert('Error - filter text must not be blank.');
            return false;
        }
        $('#mqc_hidesamples_filters').append('<li><input class="f_text" value="' + f_text + '" tabindex="' + (mqc_hidesamples_idx) + '" /><button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button></li>');
        $('#mqc_hide_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary');
        $('#mqc_hidesamples_filter').val('');
        mqc_hidesamples_idx += 1;
    });
    $('.mqc_hidesamples_showhide').change(function (e) {
        $('#mqc_hide_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary');
    });
    $('#mqc_hide_apply').click(function (e) {
        apply_mqc_hidesamples();
        $(this).attr('disabled', true).removeClass('btn-primary').addClass('btn-default');
    });

    // Filter text is changed
    $('.mqc_filters').on('blur', 'li input', function(){
        var target = $(this).parent().parent().attr('id');
        if(target == 'mqc_col_filters'){
            $('#mqc_cols_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary');
        }
        if(target == 'mqc_renamesamples_filters'){
            $('#mqc_rename_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary');
        }
        if(target == 'mqc_hidesamples_filters'){
            $('#mqc_hide_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary');
        }
    });
    // 'Enter' key pressed whilst editing a filter
    $('.mqc_filters').on('keyup', 'li input', function(e){
        if(e.keyCode == 13) { // Pressed enter
            $(this).blur();
            $(this).parent().next('li').find('input').focus().select();
        }
    });
    // Remove filter button
    $('.mqc_filters').on('click', 'li button', function(){
        var target = $(this).parent().parent().attr('id');
        $(this).parent().remove();
        if(target == 'mqc_col_filters'){ $('#mqc_cols_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary'); }
        if(target == 'mqc_hidesamples_filters'){ $('#mqc_hide_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary'); }
        if(target == 'mqc_renamesamples_filters'){ $('#mqc_rename_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary'); }
    });
    // Clear all filters button
    $('.mqc_toolbox_clear').click(function(){
        var target = $(this).closest('.mqc_filter_section').find('.mqc_filters').attr('id');
        $('#'+target).empty();
        if(target == 'mqc_col_filters'){ $('#mqc_cols_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary'); }
        if(target == 'mqc_hidesamples_filters'){ $('#mqc_hide_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary'); }
        if(target == 'mqc_renamesamples_filters'){ $('#mqc_rename_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary'); }
    });
    // Use jQuery UI to make the colour filters sortable
    $("#mqc_col_filters").sortable();
    $("#mqc_col_filters").on("sortstop", function(event, ui){
        $('#mqc_cols_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary');
    });
    // Regex mode text
    $('.mqc_regex_mode').click(function(){
        var rswitch = $(this).find('.re_mode');
        if(rswitch.text() == 'off'){
            rswitch.removeClass('off').addClass('on').text('on');
        } else {
            rswitch.removeClass('on').addClass('off').text('off');
        }
        if($(this).parent().attr('id') == 'mqc_cols'){ $('#mqc_cols_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary'); }
        if($(this).parent().attr('id') == 'mqc_renamesamples'){ $('#mqc_rename_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary'); }
        if($(this).parent().attr('id') == 'mqc_hidesamples'){ $('#mqc_hide_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary'); }
    });

    /////////////////////////
    // REGEX HELP MODAL
    /////////////////////////
    $('.regex_example_buttons button').click(function(e){
        e.preventDefault();
        $('.regex_example_demo input').val( $(this).data('example') );
        regex_example_test();
    });
    $('.regex_example_demo input').keyup(function(e){
        regex_example_test();
    });
    function regex_example_test(){
        var re = $('.regex_example_demo input').val();
        $('.regex_example_demo pre span').each(function(){
            $(this).removeClass();
            if( $(this).text().match(re) ){
                $(this).addClass('mark text-success');
            } else {
                $(this).addClass('text-muted');
            }
        });
    };

    // Change text on download button
    $('#mqc_exportplots a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
        if ($(e.target).attr('href') == '#mqc_data_download') {
            $('#mqc-dl-plot-txt').text('Data');
        } else {
            $('#mqc-dl-plot-txt').text('Images');
        }
    });

    // Export the plots
    $('#mqc_exportplots').submit(function (e) {
        e.preventDefault();
        if ($('#mqc_image_download').is(':visible')) {
            var ft = $('#mqc_export_ft').val();
            var f_scale = parseInt($('#mqc_export_scaling').val());
            var f_width = parseInt($('#mqc_exp_width').val()) / f_scale;
            var f_height = parseInt($('#mqc_exp_height').val()) / f_scale;
            var skipped_plots = 0;
            $('#mqc_export_selectplots input:checked').each(function () {
                var fname = $(this).val();
                var hc = $('#' + fname).highcharts();
                if (hc !== undefined) {
                    hc.exportChartLocal({
                        type: ft,
                        filename: fname,
                        sourceWidth: f_width,
                        sourceHeight: f_height,
                        scale: f_scale
                    });
                } else {
                    skipped_plots += 1;
                }
            });
            if (skipped_plots > 0) {
                alert("Warning: " + skipped_plots + " plots skipped.\n\nNote that it is not currently possible to export dot plot images from reports. Data exports do work.");
            }
        } else if ($('#mqc_data_download').is(':visible')) {
            var ft = $('#mqc_export_data_ft').val();
            $('#mqc_export_data_log').html('');
            $('#mqc_export_selectplots input:checked').each(function () {
                try {
                    var target = $(this).val();
                    var data = mqc_plots[target]['datasets'];
                    for (ds = 0; ds < data.length; ds++) {
                        var fname = target + '_' + (ds + 1) + '.' + ft;
                        if (ft == 'tsv' || ft == 'csv') {
                            var sep = ft == 'tsv' ? "\t" : ',';
                            datastring = '';
                            // Header line with bar graph sample names
                            if (mqc_plots[target]['plot_type'] == 'bar_graph') {
                                datastring += 'Category' + sep + mqc_plots[target]['samples'][0].join(sep) + "\n";
                            }
                            // Header line with line plot x values
                            if (mqc_plots[target]['plot_type'] == 'xy_line') {
                                datastring += 'Sample';
                                for (var j = 0; j < data[ds][0]['data'].length; j++) {
                                    datastring += sep + data[ds][0]['data'][j][0];
                                }
                                datastring += "\n";
                            }
                            // Header line for beeswarm
                            if (mqc_plots[target]['plot_type'] == 'beeswarm') {
                                datastring += 'Sample';
                                for (var j = 0; j < mqc_plots[target]['categories'].length; j++) {
                                    datastring += sep + mqc_plots[target]['categories'][j]['description'];
                                }
                                datastring += "\n";
                            }
                            // Header line for heatmap
                            if (mqc_plots[target]['plot_type'] == 'heatmap') {
                                datastring += 'x' + sep + mqc_plots[target]['xcats'].join(sep) + "\n";
                            }
                            // Beeswarm plots have crazy datastructures
                            if (mqc_plots[target]['plot_type'] == 'beeswarm') {
                                // This assumes that the same samples are in all rows
                                // TODO: Check and throw error if this isn't the case
                                var rows = Array();
                                for (var j = 0; j < mqc_plots[target]['samples'][0].length; j++) {
                                    rows[j] = Array(mqc_plots[target]['samples'][0][j]);
                                }
                                for (var j = 0; j < mqc_plots[target]['datasets'].length; j++) {
                                    for (var k = 0; k < mqc_plots[target]['datasets'][j].length; k++) {
                                        rows[k].push(mqc_plots[target]['datasets'][j][k]);
                                    }
                                }
                                for (var j = 0; j < rows.length; j++) {
                                    datastring += rows[j].join(sep) + "\n";
                                }
                            }
                            // Heatmaps also have crazy datastructures
                            else if (mqc_plots[target]['plot_type'] == 'heatmap') {
                                // First column - cat / sample name
                                datastring += mqc_plots[target]['ycats'][0];
                                var xidx = 0;
                                for (var n = 0; n < mqc_plots[target]['data'].length; n++) {
                                    // New line
                                    var x = mqc_plots[target]['data'][n][1];
                                    if (x > xidx) {
                                        datastring += "\n" + mqc_plots[target]['ycats'][x];
                                        xidx = x;
                                    }
                                    // Data val
                                    datastring += sep + mqc_plots[target]['data'][n][2];
                                }
                                datastring += "\n";
                            } else {
                                // Loop through each category (bar) or sample (line)
                                for (var i = 0; i < data[ds].length; i++) {
                                    // First column - cat / sample name
                                    datastring += data[ds][i]['name'];
                                    // line plots have x,y pairs - get just Y value
                                    if (mqc_plots[target]['plot_type'] == 'xy_line') {
                                        for (var j = 0; j < data[ds][i]['data'].length; j++) {
                                            datastring += data[ds][i]['data'][j][1] + sep;
                                        }
                                    } else {
                                        // Bar graphs have single values. Just join.
                                        datastring += sep + data[ds][i]['data'].join(sep);
                                    }
                                    datastring += "\n";
                                }
                            }
                        } else if (ft == 'json') {
                            datastring = JSON.stringify(data);
                        } else {
                            datastring = JSON.stringify(data);
                        }
                        var blob = new Blob([datastring], {type: "text/plain;charset=utf-8"});
                        saveAs(blob, fname);
                    }
                } catch (e) {
                    $('#mqc_export_data_log').append("<p class=\"text-danger\">Error: Couldn't export data from <em>" + target + "</em>.</p>");
                    console.log("Couldn't export data from '" + target);
                    console.error(e);
                }
            });
        } else {
            alert("Error - don't know what to export!");
        }
    });

    $('#mqc_cols_apply').click(function (e) {
        apply_mqc_highlights();
        $(this).attr('disabled', true).removeClass('btn-primary').addClass('btn-default');
    });

    // Select all / none for checkboxes
    $('#mqc_export_sall').click(function (e) {
        e.preventDefault();
        $('#mqc_export_selectplots input').prop('checked', true);
        x
    });
    $('#mqc_export_snone').click(function (e) {
        e.preventDefault();
        $('#mqc_export_selectplots input').prop('checked', false);
    });

    // Aspect ratio fixed
    var mqc_exp_aspect_ratio = $('#mqc_exp_width').val() / $('#mqc_exp_height').val();
    $('#mqc_export_aspratio').change(function () {
        if ($(this).is(':checked')) {
            mqc_exp_aspect_ratio = $('#mqc_exp_width').val() / $('#mqc_exp_height').val();
        }
    });
    $('#mqc_exp_width').keyup(function () {
        if ($('#mqc_export_aspratio').is(':checked')) {
            $('#mqc_exp_height').val($(this).val() / mqc_exp_aspect_ratio);
        }
    });
    $('#mqc_exp_height').keyup(function () {
        if ($('#mqc_export_aspratio').is(':checked')) {
            $('#mqc_exp_width').val($(this).val() * mqc_exp_aspect_ratio);
        }
    });

    // Highlight colour filters
    $('#mqc_color_form').submit(function (e) {
        e.preventDefault();
        var f_text = $('#mqc_colour_filter').val().trim();
        var f_col = $('#mqc_colour_filter_color').val().trim();
        $('#mqc_col_filters').append('<li style="color:' + f_col + ';"><span class="hc_handle"><span></span><span></span></span><input class="f_text" value="' + f_text + '" tabindex="' + (mqc_colours_idx) + '" /><button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button></li>');
        $('#mqc_cols_apply').attr('disabled', false).removeClass('btn-default').addClass('btn-primary');
        $('#mqc_colour_filter').val('');
        mqc_colours_idx += 1;
        if (mqc_colours_idx >= mqc_colours.length) {
            mqc_colours_idx = 0;
        }
        $('#mqc_colour_filter_color').val(mqc_colours[mqc_colours_idx]);
    });

});


//this is called once per plot/table load.
function configure_toolbox() {
    // Load the plot exporter
    $('#mqc_export_selectplots').empty();
    if ($('.hc-plot').length > 0) {
        $('.hc-plot').each(function () {
            var fname = $(this).attr('id');
            $('#mqc_export_selectplots').append('<div class="checkbox"><label><input type="checkbox" value="' + fname + '" checked> ' + fname + '</label></div>');
        });
    } else {
        $('#mqc_exportplots').hide();
        $('.mqc-toolbox-buttons a[href=#mqc_exportplots]').parent().hide();
    }

    if (notEmptyObj(window.mqc_highlight_f_texts)){
        $(document).trigger('mqc_highlights', [window.mqc_highlight_f_texts, window.mqc_highlight_f_cols, window.mqc_highlight_regex_mode]);
    }
    if (notEmptyObj(window.mqc_rename_f_texts)){
        $(document).trigger('mqc_renamesamples', [window.mqc_rename_f_texts, window.mqc_rename_t_texts, window.mqc_rename_regex_mode]);
    }
    if (notEmptyObj(window.mqc_hide_f_texts)){
        $(document).trigger('mqc_hidesamples', [window.mqc_hide_f_texts, window.mqc_hide_regex_mode]);
    }
}

//////////////////////////////////////////////////////
// GENERAL TOOLBOX FUNCTIONS
//////////////////////////////////////////////////////
function mqc_toolbox_openclose (target, open){
    // Hide any open tooltip so it's not left dangling
    $('.mqc-toolbox-buttons li a').tooltip('hide');
    // Find if what we clicked is already open
    var btn = $('.mqc-toolbox-buttons li a[href="'+target+'"]');
    if(open === undefined){
        if(btn.hasClass('active')){ open = false; }
        else { open = true; }
    }
    var already_open = $('.mqc-toolbox').hasClass('active');
    if(open){
        if(already_open){
            mqc_toolbox_confirmapply();
        }
        $('.mqc-toolbox, .mqc-toolbox-buttons li a, .mqc_filter_section').removeClass('active');
        btn.addClass('active');
        $('.mqc-toolbox, '+target).addClass('active');
        $(document).trigger('mqc_toolbox_open');
        var timeout = already_open ? 0 : 510;
        setTimeout(function(){
            if(target == '#mqc_cols'){ $('#mqc_colour_filter').focus(); }
            if(target == '#mqc_renamesamples'){ $('#mqc_renamesamples_from').focus(); }
            if(target == '#mqc_hidesamples'){ $('#mqc_hidesamples_filter').focus(); }
        }, timeout);
    } else {
        mqc_toolbox_confirmapply();
        btn.removeClass('active');
        $('.mqc-toolbox, .mqc-toolbox-buttons li a').removeClass('active');
        $(document).trigger('mqc_toolbox_close');
    }
}
function mqc_toolbox_confirmapply(){
    // Check if there's anything waiting to be applied
    if($('#mqc_cols_apply').is(':enabled') && $('#mqc_cols').is(':visible')){
        if(confirm('Apply highlights?')){
            $('#mqc_cols_apply').trigger('click');
        }
    }
    if($('#mqc_rename_apply').is(':enabled') && $('#mqc_renamesamples').is(':visible')){
        if(confirm('Apply rename patterns?')){
            $('#mqc_rename_apply').trigger('click');
        }
    }
    if($('#mqc_hide_apply').is(':enabled') && $('#mqc_hidesamples').is(':visible')){
        if(confirm('Hide samples?')){
            $('#mqc_hide_apply').trigger('click');
        }
    }
}

//////////////////////////////////////////////////////
// HIGHLIGHT SAMPLES
//////////////////////////////////////////////////////
function apply_mqc_highlights(){

    // Collect the filters into an array
    var f_texts = [];
    var f_cols = [];
    var regex_mode = false;
    if($('#mqc_cols .mqc_regex_mode .re_mode').hasClass('on')){
        regex_mode = true;
    }
    $('#mqc_col_filters li .f_text').each(function(){
        f_texts.push($(this).val());
        f_cols.push($(this).css('color'));
    });

    // Apply a 'background' highlight to remove default colouring first
    // Also highlight toolbox drawer icon
    if(f_texts.length > 0){
        f_texts.unshift('');
        f_cols.unshift('#cccccc');
        $('.mqc-toolbox-buttons a[href="#mqc_cols"]').addClass('in_use');
    } else {
        $('.mqc-toolbox-buttons a[href="#mqc_cols"]').removeClass('in_use');
    }

    window.mqc_highlight_f_texts = f_texts;
    window.mqc_highlight_f_cols = f_cols;
    window.mqc_highlight_regex_mode = regex_mode;

    // Fire off a custom jQuery event for other javascript chunks to tie into
    $(document).trigger('mqc_highlights', [f_texts, f_cols, regex_mode]);
}

//////////////////////////////////////////////////////
// RENAME SAMPLES
//////////////////////////////////////////////////////

function apply_mqc_renamesamples(){

    // Collect filters
    var f_texts = [];
    var t_texts = [];
    var regex_mode = false;
    $('#mqc_renamesamples_filters .from_text').each(function(){ f_texts.push($(this).val()); });
    $('#mqc_renamesamples_filters .to_text').each(function(){ t_texts.push($(this).val()); });
    if($('#mqc_renamesamples .mqc_regex_mode .re_mode').hasClass('on')){ regex_mode = true; }

    // If something was renamed, highlight the toolbox icon
    if(f_texts.length > 0){
        $('.mqc-toolbox-buttons a[href="#mqc_renamesamples"]').addClass('in_use');
    } else {
        $('.mqc-toolbox-buttons a[href="#mqc_renamesamples"]').removeClass('in_use');
    }

    window.mqc_rename_f_texts = f_texts;
    window.mqc_rename_t_texts = t_texts;
    window.mqc_rename_regex_mode = regex_mode;

    // Fire off a custom jQuery event for other javascript chunks to tie into
    $(document).trigger('mqc_renamesamples', [f_texts, t_texts, regex_mode]);
}

//////////////////////////////////////////////////////
// HIDE SAMPLES
//////////////////////////////////////////////////////
function apply_mqc_hidesamples(){
    // Collect the filters into an array
    var mode = $('.mqc_hidesamples_showhide:checked').val() == 'show' ? 'show' : 'hide';
    var f_texts = [];
    var regex_mode = false;
    if($('#mqc_hidesamples .mqc_regex_mode .re_mode').hasClass('on')){
        regex_mode = true;
    }
    $('#mqc_hidesamples_filters li .f_text').each(function(){
        f_texts.push($(this).val());
    });

    // If something was hidden, highlight the toolbox icon
    if(f_texts.length > 0){
        $('.mqc-toolbox-buttons a[href="#mqc_hidesamples"]').addClass('in_use');
    } else {
        $('.mqc-toolbox-buttons a[href="#mqc_hidesamples"]').removeClass('in_use');
    }

    window.mqc_hide_mode = mode;
    window.mqc_hide_f_texts = f_texts;
    window.mqc_hide_regex_mode = regex_mode;

    // Fire off a custom jQuery event for other javascript chunks to tie into
    $(document).trigger('mqc_hidesamples', [f_texts, regex_mode]);
}
</script>
<script type="text/javascript">
////////////////////////////////////////////////
// Base JS for MultiQC Reports
////////////////////////////////////////////////

// Helper config - is defined and object length > 0?
function notEmptyObj (obj){
  try{
    if(obj === undefined){ return false; }
    if(obj.length == 0){ return false; }
  } catch(e){ return false; }
  return true;
}

$(function () {

  // Enable the bootstrap tooltip hovers
  $('[data-toggle="tooltip"]').tooltip();

  // Side nav expansion
  $('#side-nav-handle').click(function(e){
    $('.mainpage, .side-nav, .footer').toggleClass('hidden-nav');
    $('#side-nav-handle span').toggleClass('glyphicon-triangle-left glyphicon-triangle-right');
    // send resize trigger for replotting after css animation
    setTimeout(function(){ $(document).resize(); }, 510);
  });

  // Hide welcome alert if setting saved
  try {
    var hide_welcome = localStorage.getItem("mqc_hide_welcome");
    if(hide_welcome !== 'true'){
      $('#mqc_header_hr').slideUp();
      $('#mqc_welcome').slideDown();
    }
    $('#mqc_hide_welcome_btn').click(function(e){
      localStorage.setItem("mqc_hide_welcome", 'true');
    });
  } catch(e){
    console.log("Could not access localStorage: "+e+"\nPlease disable 'Block third-party cookies and site data' or browser equivalent.")
  }
  $('#mqc_hide_welcome_btn, #mqc_welcome .close').click(function(e){
    $('#mqc_header_hr').show();
  });

});</script>
<script type="text/javascript">
////////////////////////////////////////////////
// HighCharts Plotting Code
////////////////////////////////////////////////

// Global plot data variable
mqc_plots = {};

// Initialise the toolbox filters
window.mqc_highlight_f_texts = [];
window.mqc_highlight_f_cols = [];
window.mqc_highlight_regex_mode = false;
window.mqc_rename_f_texts = [];
window.mqc_rename_t_texts = [];
window.mqc_rename_regex_mode = false;
window.mqc_hide_mode = 'hide';
window.mqc_hide_f_texts = [];
window.mqc_hide_regex_mode = false;
window.HCDefaults = undefined;

// Execute when page load has finished loading
// Replot graphs when something changed in filters
$(document).on('mqc_highlights mqc_renamesamples mqc_hidesamples', function(){
    // Replot graphs
    $('.hc-plot:not(.not_rendered)').each(function(){
        var target = $(this).attr('id');
        plot_graph(target);
    });
});

function render_plots() {
    mqc_plots = mqc_compressed_plotdata;

    // HighCharts Defaults
    window.HCDefaults = $.extend(true, {}, Highcharts.getOptions(), {});
    Highcharts.setOptions({
        credits: {
            enabled: true,
            text: 'Created with VariantQC',
            href: 'https://bimberlab.github.io/DISCVRSeq/'
        },
        lang: {
            decimalPoint: (mqc_config['decimalPoint_format'] == undefined ? '.' : mqc_config['decimalPoint_format']),
            thousandsSep: (mqc_config['thousandsSep_format'] == undefined ? ' ' : mqc_config['thousandsSep_format']),
        },
        exporting: {
            buttons: {
                contextButton: {
                    menuItems: null,
                    onclick: function () {
                        // Tick only this plot in the toolbox and slide out
                        $('#mqc_export_selectplots input').prop('checked', false);
                        $('#mqc_export_selectplots input[value="'+this.renderTo.id+'"]').prop('checked', true);
                        // Special case - Table scatter plots are in a modal, need to close this first
                        if(this.renderTo.id == 'tableScatterPlot'){
                            $('#tableScatterModal').modal('hide');
                        }
                        mqc_toolbox_openclose('#mqc_exportplots', true);
                    },
                    text: '<span style="color:#999999;">Export Plot</span>',
                    symbol: 'url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAAXNJREFUOBHNUsuqwkAMPX2g4kJd+wOCuKgL//8btAXXIogvtOhCax9xzkBqveLg8gamHZKck+RMgP9mnquh5XIpaZrC8zx0Oh1EUfQ1P3QRkeR6vcL3fdxuN1cqnERhGIKHREEQOIl8V1RE0DyuXCeRC/g39iFeHMdSlqUV+HK5oCgKeyew1+vZEauqwnQ6fcN+aJTnObbbLdrtttWGL0bjiBT/fr9jMBhYX/PzxsrA4/EQ8+zY7/dotVpgdRoFZ5F+v4/ZbPaBCw+Hg8znc5s8Ho8J9kxV04DAxCwZg6aAJWEO7XQ6yWKxQJZlGI1Gr+fXEZhkls8zCTUZfexkMpmg2+2+dUMci1qNlKS5K0YjC0iSRDgSO1EfiblfxOmpxaaDr3Q8HqWpC1+NFbnhu91OSMKC5/OZ19pqIoq5Xq+xWq3qIAnoZxFdCQ3Sx65o9WisqsYENb0rofr1T3Iexi1qs9mIgjTp1z9JhsPhq/qvwG95Tw3FukJt8JteAAAAAElFTkSuQmCC)',
                    symbolX: 23,
                    symbolY: 19
                }
            }
        }
    });

    // Render plots on page load
    $('.hc-plot:not(.no-handle)').each(function(){
        var target = $(this).attr('id');
        // Only one point per dataset, so multiply limit by arbitrary number.
        var max_num = num_datasets_plot_limit * 50;
        plot_graph(target, undefined, max_num);
    }).promise().done(function(){ $('.mqc_loading_warning').hide(); });

    // Render a plot when clicked
    $('body').on('click', '.render_plot', function(e){
        var target = $(this).parent().attr('id');
        plot_graph(target);
        if($('.hc-plot.not_rendered').length == 0){
            $('#mqc-warning-many-samples').hide();
        }
    });

    // Render all plots from header
    $('#mqc-render-all-plots').click(function(){
        $('.hc-plot.not_rendered').each(function(){
            var target = $(this).attr('id');
            plot_graph(target);
        });
        $('#mqc-warning-many-samples').hide();
    });

    // Switch a HighCharts axis or data source
    $('.hc_switch_group button').click(function(e){
        e.preventDefault();
        $(this).siblings('button.active').removeClass('active');
        $(this).addClass('active');
        var target = $(this).data('target');
        var action = $(this).data('action');
        // Switch between values and percentages
        if(action == 'set_percent' || action == 'set_numbers'){
            var sym = (action == 'set_percent') ? '%' : '#';
            var stack_type = (action == 'set_percent') ? 'percent' : 'normal';
            mqc_plots[target]['config']['stacking'] = stack_type;
            mqc_plots[target]['config']['ytype'] = 'linear';
            plot_graph(target);
            var ylab = $(this).data('ylab');
            if(ylab != undefined){
                $('#'+target).highcharts().yAxis[0].setTitle({ text: ylab });
            }
        }
        // Switch to log10 axis
        if(action == 'set_log'){
            mqc_plots[target]['config']['ytype'] = 'logarithmic';
            plot_graph(target);
        }
        // Switch data source
        if(action == 'set_data'){
            var ds = $(this).data('newdata');
            plot_graph(target, ds);
            var ylab = $(this).data('ylab');
            var ymax = $(this).data('ymax');
            if(ylab != undefined){
                $('#'+target).highcharts().yAxis[0].setTitle({ text: ylab });
            }
            if(ymax != undefined){
                $('#'+target).highcharts().yAxis[0].setExtremes(null, ymax);
            }
        }
    });

    // Make HighCharts divs height-draggable
    // http://jsfiddle.net/Lkwb86c8/
    $('.hc-plot:not(.no-handle)').each(function(){
        if(!$(this).parent().hasClass('hc-plot-wrapper')){
            $(this).wrap('<div class="hc-plot-wrapper"></div>');
        }
        if(!$(this).siblings().hasClass('hc-plot-handle')){
            $(this).after('<div class="hc-plot-handle"><span></span><span></span><span></span></div>');
        }
        $(this).css({ height: 'auto', top: 0, bottom: '10px', position: 'absolute' });
    });
    $('.hc-plot-handle').on('mousedown', function(e){
        var wrapper = $(this).parent();
        var handle = $(this);
        var startHeight = wrapper.height();
        var pY = e.pageY;
        $(document).on('mouseup', function(e){
            // Clear listeners now that we've let go
            $(document).off('mousemove');
            $(document).off('mouseup');
            // Fire off a custom jQuery event for other javascript chunks to tie into
            // Bind to the plot div, which should have a custom ID
            $(wrapper.parent().find('.hc-plot, .beeswarm-plot')).trigger('mqc_plotresize');
        });
        $(document).on('mousemove', function(me){
            wrapper.css('height', startHeight + (me.pageY - pY));
        });
    });
    // Trigger HighCharts reflow when a plot is resized
    $('.hc-plot, .beeswarm-plot').on('mqc_plotresize', function(e){
        if($(this).highcharts()) {
            $(this).highcharts().reflow();
        }
    });

    // Switch a y axis limit on or off
    $('.mqc_hcplot_plotgroup').on('click', '.mqc_hcplot_yaxis_limit_toggle .mqc_switch_wrapper', function(){
        var target = $( $(this).data('target') ).highcharts();
        var ymax = $(this).data('ymax');
        var ymin = $(this).data('ymin');
        ymax = ymax == 'undefined' ? null : ymax;
        ymin = ymin == 'undefined' ? null : ymin;
        var mqc_switch = $(this).find('.mqc_switch');
        if(mqc_switch.hasClass('on')){
            target.yAxis[0].update({max: null, min:null});
            mqc_switch.removeClass('on').addClass('off').text('off');
        } else {
            target.yAxis[0].update({max: ymax, min: ymin});
            mqc_switch.removeClass('off').addClass('on').text('on');
        }
    });

    // Sort a heatmap by highlighted names
    $('.mqc_heatmap_sortHighlight').click(function(e){
        e.preventDefault();
        var target = $(this).data('target').substr(1);
        if(mqc_plots[target]['config']['sortHighlights'] == true){
            mqc_plots[target]['config']['sortHighlights'] = false;
            $(this).removeClass('active');
        } else {
            mqc_plots[target]['config']['sortHighlights'] = true;
            $(this).addClass('active');
        }
        $(this).blur();
        plot_heatmap(target);
    });

}

// Call to render any plot
function plot_graph(target, ds, max_num){
    if(mqc_plots[target] === undefined){ return false; }
    else {
        // XY Line charts
        if(mqc_plots[target]['plot_type'] == 'xy_line'){
            if(max_num === undefined || mqc_plots[target]['datasets'][0].length < max_num){
                plot_xy_line_graph(target, ds);
                $('#'+target).removeClass('not_rendered');
            } else {
                $('#'+target).addClass('not_rendered').html('<button class="btn btn-default btn-lg render_plot">Show plot</button>');
            }
        }
        // Bar graphs
        else if(mqc_plots[target]['plot_type'] == 'bar_graph'){
            if(max_num === undefined || mqc_plots[target]['samples'][0].length < max_num){
                plot_stacked_bar_graph(target, ds);
                $('#'+target).removeClass('not_rendered');
            } else {
                $('#'+target).addClass('not_rendered').html('<button class="btn btn-default btn-lg render_plot">Show plot</button>');
            }
        }
        // Scatter plots
        else if(mqc_plots[target]['plot_type'] == 'scatter'){
            if(max_num === undefined || Object.keys(mqc_plots[target]['datasets'][0]).length < max_num){
                plot_scatter_plot(target, ds);
                $('#'+target).removeClass('not_rendered');
            } else {
                $('#'+target).addClass('not_rendered').html('<button class="btn btn-default btn-lg render_plot">Show plot</button>');
            }
        }
        // Beeswarm graphs
        else if(mqc_plots[target]['plot_type'] == 'beeswarm'){
            if(max_num === undefined || mqc_plots[target]['samples'][0].length < max_num){
                plot_beeswarm_graph(target, ds);
                $('#'+target).removeClass('not_rendered');
            } else {
                $('#'+target).addClass('not_rendered').html('<button class="btn btn-default btn-lg render_plot">Show plot</button>');
            }
        }
        // Heatmap plots
        else if(mqc_plots[target]['plot_type'] == 'heatmap'){
            if(max_num === undefined || mqc_plots[target]['xcats'][0].length < max_num){
                plot_heatmap(target, ds);
                $('#'+target).removeClass('not_rendered');
            } else {
                $('#'+target).addClass('not_rendered').html('<button class="btn btn-default btn-lg render_plot">Show plot</button>');
            }
        }
        // Bar graphs
        else if(mqc_plots[target]['plot_type'] == 'histogram'){
            if (!mqc_plots[target]['samples']){
                console.log('error')
            }
            if(max_num === undefined || mqc_plots[target]['samples'][0].length < max_num){
                plot_histogram(target, ds);
                $('#'+target).removeClass('not_rendered');
            } else {
                $('#'+target).addClass('not_rendered').html('<button class="btn btn-default btn-lg render_plot">Show plot</button>');
            }
        }
        // Not recognised
        else { console.log('Did not recognise plot type: '+mqc_plots[target]['plot_type']); }
    }
}

// Basic Line Graph
function plot_xy_line_graph(target, ds){
    if(mqc_plots[target] === undefined || mqc_plots[target]['plot_type'] !== 'xy_line'){
        return false;
    }
    var config = mqc_plots[target]['config'];
    var data = mqc_plots[target]['datasets'];
    if(ds === undefined){ ds = 0; }

    if(config['tt_label'] === undefined){ config['tt_label'] = '{point.x}: {point.y:.2f}'; }
    if(config['click_func'] === undefined){ config['click_func'] = function(){}; }
    else {
        config['click_func'] = eval("("+config['click_func']+")");
        if(config['cursor'] === undefined){ config['cursor'] = 'pointer'; }
    }
    if (config['xDecimals'] === undefined){ config['xDecimals'] = true; }
    if (config['yDecimals'] === undefined){ config['yDecimals'] = true; }
    if (config['pointFormat'] === undefined){
        config['pointFormat'] = '<div style="background-color:{series.color}; display:inline-block; height: 10px; width: 10px; border:1px solid #333;"></div> <span style="text-decoration:underline; font-weight:bold;">{series.name}</span><br>'+config['tt_label'];
    }

    // Make a clone of the data, so that we can mess with it,
    // while keeping the original data in tact
    var data = JSON.parse(JSON.stringify(mqc_plots[target]['datasets'][ds]));

    // Rename samples
    if(window.mqc_rename_f_texts.length > 0){
        $.each(data, function(j, s){
            $.each(window.mqc_rename_f_texts, function(idx, f_text){
                if(window.mqc_rename_regex_mode){
                    var re = new RegExp(f_text,"g");
                    data[j]['name'] = data[j]['name'].replace(re, window.mqc_rename_t_texts[idx]);
                } else {
                    data[j]['name'] = data[j]['name'].replace(f_text, window.mqc_rename_t_texts[idx]);
                }
            });
        });
    }

    // Highlight samples
    if(window.mqc_highlight_f_texts.length > 0){
        $.each(data, function(j, s){
            $.each(window.mqc_highlight_f_texts, function(idx, f_text){
                if((window.mqc_highlight_regex_mode && data[j]['name'].match(f_text)) || (!window.mqc_highlight_regex_mode && data[j]['name'].indexOf(f_text) > -1)){
                    data[j]['color'] = window.mqc_highlight_f_cols[idx];
                }
            });
        });
    }

    // Hide samples
    $('#'+target).closest('.mqc_hcplot_plotgroup').parent().find('.samples-hidden-warning').remove();
    $('#'+target).closest('.mqc_hcplot_plotgroup').show();
    if(window.mqc_hide_f_texts.length > 0){
        var num_hidden = 0;
        var num_total = data.length;
        var j = data.length;
        while (j--) {
            var match = false;
            for (i = 0; i < window.mqc_hide_f_texts.length; i++) {
                var f_text = window.mqc_hide_f_texts[i];
                if(window.mqc_hide_regex_mode){
                    if(data[j]['name'].match(f_text)){ match = true; }
                } else {
                    if(data[j]['name'].indexOf(f_text) > -1){ match = true; }
                }
            }
            if(window.mqc_hide_mode == 'show'){
                match = !match;
            }
            if(match){
                data.splice(j,1);
                num_hidden += 1;
            }
        };
        // Some series hidden. Show a warning text string.
        if(num_hidden > 0) {
            var alert = '<div class="samples-hidden-warning alert alert-warning"><span class="glyphicon glyphicon-info-sign"></span> <strong>Warning:</strong> '+num_hidden+' samples hidden. <a href="#mqc_hidesamples" class="alert-link" onclick="mqc_toolbox_openclose(\'#mqc_hidesamples\', true); return false;">See toolbox.</a></div>';
            $('#'+target).closest('.mqc_hcplot_plotgroup').before(alert);
        }
        // All series hidden. Hide the graph.
        if(num_hidden == num_total){
            $('#'+target).closest('.mqc_hcplot_plotgroup').hide();
            return false;
        }
    }

    // Toggle buttons for y-axis limis
    // Handler for this is at top, so doesn't get created multiple times
    if(config['ymax'] != undefined || config['ymin'] != undefined ){
        var pgroup = $('#'+target).closest('.mqc_hcplot_plotgroup');
        var wrapper = $('<div class="mqc_hcplot_yaxis_limit_toggle hidden-xs" />').prependTo(pgroup);
        wrapper.append('<span class="mqc_switch_wrapper" data-ymax="'+config['ymax']+'" data-ymin="'+config['ymin']+'" data-target="#'+target+'">Y-Limits: <span class="mqc_switch on">on</span></span>');
        wrapper.after('<div class="clearfix" />');
    }

    // Make the highcharts plot
    Highcharts.chart(target, {
        chart: {
            type: 'line',
            zoomType: 'x'
        },
        title: {
            text: config['title'],
            x: 30 // fudge to center over plot area rather than whole plot
        },
        xAxis: {
            title: {
                text: config['xlab']
            },
            type: config['xLog'] ? 'logarithmic' : 'linear',
            categories: config['categories'],
            ceiling: config['xCeiling'],
            floor: config['xFloor'],
            max: config['xmax'],
            min: config['xmin'],
            minRange: config['xMinRange'],
            allowDecimals: config['xDecimals'],
            plotBands: config['xPlotBands'],
            plotLines: config['xPlotLines']
        },
        yAxis: {
            title: {
                text: config['ylab']
            },
            type: config['yLog'] ? 'logarithmic' : 'linear',
            ceiling: config['yCeiling'],
            floor: config['yFloor'],
            max: config['ymax'],
            min: config['ymin'],
            minRange: config['yMinRange'],
            allowDecimals: config['yDecimals'],
            plotBands: config['yPlotBands'],
            plotLines: config['yPlotLines']
        },
        plotOptions: {
            series: {
                marker: { enabled: false },
                cursor: config['cursor'],
                point: {
                    events: {
                        click: config['click_func']
                    }
                }
            }
        },
        legend: {
            enabled: false
        },
        tooltip: {
            headerFormat: '',
            pointFormat: config['pointFormat'],
            useHTML: true
        },
        series: data
    });
}

// Stacked Bar Graph
function plot_stacked_bar_graph(target, ds){
    if(mqc_plots[target] === undefined || mqc_plots[target]['plot_type'] !== 'bar_graph'){
        return false;
    }
    var config = mqc_plots[target]['config'];
    if(ds === undefined){ ds = 0; }
    if (config['stacking'] === undefined){ config['stacking'] = 'normal'; }
    if (config['ytype'] === undefined){ config['ytype'] = 'linear'; }
    if (config['reversedStacks'] === undefined){ config['reversedStacks'] = false; }
    if (config['use_legend'] === undefined){ config['use_legend'] = true; }
    if (config['yDecimals'] === undefined){ config['yDecimals'] = true; }
    if(config['click_func'] === undefined){ config['click_func'] = function(){}; }
    else { if(config['cursor'] === undefined){ config['cursor'] = 'pointer'; } }
    if (config['tt_percentages'] === undefined){ config['tt_percentages'] = true; }

    // Make a clone of the data, so that we can mess with it,
    // while keeping the original data in tact
    var data = JSON.parse(JSON.stringify(mqc_plots[target]['datasets'][ds]));
    var cats = JSON.parse(JSON.stringify(mqc_plots[target]['samples'][ds]));

    if (config['ytype'] == 'logarithmic'){
        if(config['ymin'] == 0 || config['ymin'] == undefined){
            config['ymin'] = 1;
        }
        var minTickInt = 'auto';
    } else {
        var minTickInt = undefined;
    }

    // Rename samples
    if(window.mqc_rename_f_texts.length > 0){
        $.each(cats, function(j, s_name){
            $.each(window.mqc_rename_f_texts, function(idx, f_text){
                if(window.mqc_rename_regex_mode){
                    var re = new RegExp(f_text,"g");
                    cats[j] = cats[j].replace(re, window.mqc_rename_t_texts[idx]);
                } else {
                    cats[j] = cats[j].replace(f_text, window.mqc_rename_t_texts[idx]);
                }
            });
        });
    }

    // Highlight samples
    if(window.mqc_highlight_f_texts.length > 0){
        $.each(cats, function(j, s_name){
            $.each(window.mqc_highlight_f_texts, function(idx, f_text){
                if(f_text == ''){ return true; } // skip blanks
                if((window.mqc_highlight_regex_mode && s_name.match(f_text)) || (!window.mqc_highlight_regex_mode && s_name.indexOf(f_text) > -1)){
                    // Make the data point in each series with this index have a border colour
                    $.each(data, function(k, d){
                        data[k]['data'][j] = {
                            'y': data[k]['data'][j],
                            'borderColor': window.mqc_highlight_f_cols[idx]
                        }
                    });
                }
            });
        });
        // Bump the borderWidth to make the highlights more obvious
        if(config['borderWidth'] === undefined){ config['borderWidth'] = 5; }
    }

    // Hide samples
    $('#'+target).closest('.mqc_hcplot_plotgroup').parent().find('.samples-hidden-warning').remove();
    $('#'+target).closest('.mqc_hcplot_plotgroup').show();
    if(window.mqc_hide_f_texts.length > 0){
        var num_hidden = 0;
        var num_total = cats.length;
        var j = cats.length;
        while (j--) {
            var s_name = cats[j];
            var match = false;
            for (i = 0; i < window.mqc_hide_f_texts.length; i++) {
                var f_text = window.mqc_hide_f_texts[i];
                if(window.mqc_hide_regex_mode){
                    if(s_name.match(f_text)){ match = true; }
                } else {
                    if(s_name.indexOf(f_text) > -1){ match = true; }
                }
            }
            if(window.mqc_hide_mode == 'show'){
                match = !match;
            }
            if(match){
                cats.splice(j, 1);
                $.each(data, function(k, d){
                    data[k]['data'].splice(j, 1);
                });
                num_hidden += 1;
            }
        };
        // Some series hidden. Show a warning text string.
        if(num_hidden > 0) {
            var alert = '<div class="samples-hidden-warning alert alert-warning"><span class="glyphicon glyphicon-info-sign"></span> <strong>Warning:</strong> '+num_hidden+' samples hidden. <a href="#mqc_hidesamples" class="alert-link" onclick="mqc_toolbox_openclose(\'#mqc_hidesamples\', true); return false;">See toolbox.</a></div>';
            $('#'+target).closest('.mqc_hcplot_plotgroup').before(alert);
        }
        // All series hidden. Hide the graph.
        if(num_hidden == num_total){
            $('#'+target).closest('.mqc_hcplot_plotgroup').hide();
            return false;
        }
    }

    // Make the highcharts plot
    Highcharts.chart(target, {
        chart: {
            type: 'bar'
        },
        title: {
            text: config['title'],
        },
        xAxis: {
            categories: cats,
            min: 0,
            title: {
                text: config['xlab']
            },
        },
        yAxis: {
            title: {
                text: config['ylab']
            },
            ceiling: config['yCeiling'],
            floor: config['yFloor'],
            minRange: config['yMinRange'],
            max: config['ymax'],
            min: config['ymin'],
            type: config['ytype'],
            labels: {
                format: config['ylab_format']
            },
            allowDecimals: config['yDecimals'],
            reversedStacks: config['reversedStacks'],
            minorTickInterval: minTickInt
        },
        plotOptions: {
            series: {
                stacking: config['stacking'],
                groupPadding: 0.02,
                borderWidth: config['borderWidth']
            },
            cursor: config['cursor'],
            point: {
                events: {
                    click: config['click_func']
                }
            }
        },
        legend: {
            enabled: config['use_legend']
        },
        tooltip: {
            formatter: function () {
                var colspan = config['tt_percentages'] ? 3 : 2;
                var s = '<table><tr><th colspan="'+colspan+'" style="font-weight:bold; text-decoration:underline;">' + this.x + '</th></tr>';
                $.each(this.points, function () {
                    yval = Highcharts.numberFormat(this.y, (config['tt_decimals'] == undefined ? 0 : config['tt_decimals'])) + ( config['tt_suffix'] || '');
                    ypct = Highcharts.numberFormat(this.percentage, 1);
                    s += '<tr> \
            <td style="font-weight:bold; color:'+this.series.color+'; border-bottom:1px solid #dedede;">' + this.series.name + ':</td>\
            <td style="text-align:right; border-bottom:1px solid #dedede; padding: 0 15px;">' + yval + '</td>';
                    if(config['tt_percentages']){
                        s += '<td style="text-align:right; border-bottom:1px solid #dedede;">(' + ypct + '%)</td>';
                    }
                    s += '</tr>';
                });
                s += '</table>';
                return s;
            },
            shared: true,
            useHTML: true
        },
        series: data
    });
}

//histogram
function plot_histogram(target, ds) {
    if(mqc_plots[target] === undefined || mqc_plots[target]['plot_type'] !== 'histogram'){
        return false;
    }
    var config = mqc_plots[target]['config'];
    var data = mqc_plots[target]['datasets'];
    if(ds === undefined){ ds = 0; }

    if(config['marker_colour'] === undefined){ config['marker_colour'] = 'rgba(124, 181, 236, .5)'; }
    if(config['marker_size'] === undefined){ config['marker_size'] = 5; }
    if(config['marker_line_colour'] === undefined){ config['marker_line_colour'] = '#999'; }
    if(config['marker_line_width'] === undefined){ config['marker_line_width'] = 1; }
    if(config['tt_label'] === undefined){ config['tt_label'] = 'X: <strong>{point.x:.2f}</strong><br/>Y: <strong>{point.y:.2f}</strong>'; }
    if(config['click_func'] === undefined){ config['click_func'] = function(){ }; }
    else {
        config['click_func'] = eval("("+config['click_func']+")");
        if(config['cursor'] === undefined){ config['cursor'] = 'pointer'; }
    }
    if (config['xDecimals'] === undefined){ config['xDecimals'] = true; }
    if (config['pointFormat'] === undefined){
        config['pointFormat'] = '<div style="background-color:{point.color}; display:inline-block; height: 10px; width: 10px; border:1px solid #333;"></div> <span style="text-decoration:underline; font-weight:bold;">{point.name}</span><br>'+config['tt_label'];
    }

    // Make a clone of the data, so that we can mess with it,
    // while keeping the original data in tact
    var data = JSON.parse(JSON.stringify(mqc_plots[target]['datasets'][ds]));

    // Rename samples
    if(window.mqc_rename_f_texts.length > 0){
        $.each(data, function(j, s){
            $.each(window.mqc_rename_f_texts, function(idx, f_text){
                if(window.mqc_rename_regex_mode){
                    var re = new RegExp(f_text,"g");
                    data[j]['name'] = data[j]['name'].replace(re, window.mqc_rename_t_texts[idx]);
                } else {
                    data[j]['name'] = data[j]['name'].replace(f_text, window.mqc_rename_t_texts[idx]);
                }
            });
        });
    }

    // Highlight samples
    if(window.mqc_highlight_f_texts.length > 0){
        $.each(data, function(j, s){
            if ('marker' in data[j]){
                data[j]['marker']['lineWidth'] = 0;
            } else {
                data[j]['marker'] = {'lineWidth': 0};
            }
            var match = false;
            $.each(window.mqc_highlight_f_texts, function(idx, f_text){
                if(f_text == ''){ return true; }
                if((window.mqc_highlight_regex_mode && data[j]['name'].match(f_text)) || (!window.mqc_highlight_regex_mode && data[j]['name'].indexOf(f_text) > -1)){
                    data[j]['color'] = window.mqc_highlight_f_cols[idx];
                    match = true;
                }
            });
            if(!match) {
                data[j]['color'] = 'rgba(100,100,100,0.2)';
            }
        });
    }

    // Hide samples
    $('#'+target).closest('.mqc_hcplot_plotgroup').parent().find('.samples-hidden-warning').remove();
    $('#'+target).closest('.mqc_hcplot_plotgroup').show();
    if(window.mqc_hide_f_texts.length > 0){
        var num_hidden = 0;
        var num_total = data.length;
        var j = data.length;
        while (j--) {
            var match = false;
            for (i = 0; i < window.mqc_hide_f_texts.length; i++) {
                var f_text = window.mqc_hide_f_texts[i];
                if(window.mqc_hide_regex_mode){
                    if(data[j]['name'].match(f_text)){ match = true; }
                } else {
                    if(data[j]['name'].indexOf(f_text) > -1){ match = true; }
                }
            }
            if(window.mqc_hide_mode == 'show'){
                match = !match;
            }
            if(match){
                data.splice(j,1);
                num_hidden += 1;
            }
        };
        // Some series hidden. Show a warning text string.
        if(num_hidden > 0) {
            var alert = '<div class="samples-hidden-warning alert alert-warning"><span class="glyphicon glyphicon-info-sign"></span> <strong>Warning:</strong> '+num_hidden+' samples hidden. <a href="#mqc_hidesamples" class="alert-link" onclick="mqc_toolbox_openclose(\'#mqc_hidesamples\', true); return false;">See toolbox.</a></div>';
            $('#'+target).closest('.mqc_hcplot_plotgroup').before(alert);
        }
        // All series hidden. Hide the graph.
        if(num_hidden == num_total){
            $('#'+target).closest('.mqc_hcplot_plotgroup').hide();
            return false;
        }
    }

    // Make the highcharts plot
    Highcharts.chart(target, {
            chart: {
                type: 'column',
                //zoomType: 'xy',
                plotBorderWidth: 1,
                height: config['square'] ? 500 : undefined,
                width: config['square'] ? 500 : undefined
            },
            title: {
                text: config['title'],
                x: 30 // fudge to center over plot area rather than whole plot
            },
            xAxis: {
                title: {
                    text: config['xlab']
                },
                type: 'linear',
                gridLineWidth: 1,
                categories: config['categories'],
                ceiling: config['xCeiling'],
                floor: config['xFloor'],
                max: config['xmax'],
                min: config['xmin'],
                minRange: config['xMinRange'],
                allowDecimals: config['xDecimals'],
                plotBands: config['xPlotBands'],
                plotLines: config['xPlotLines']
            },
            yAxis: {
                title: {
                    text: config['ylab'] || 'Count'
                },
                type: config['yLog'] ? 'logarithmic' : 'linear',
                ceiling: config['yCeiling'],
                floor: config['yFloor'],
                max: config['ymax'],
                min: config['ymin'],
                minRange: config['yMinRange'],
                allowDecimals: config['yDecimals'],
                plotBands: config['yPlotBands'],
                plotLines: config['yPlotLines']
            },
            plotOptions: {
                series: {
                    animation: false,
                    marker: {
                        radius: config['marker_size'],
                        lineColor: config['marker_line_colour'],
                        lineWidth: config['marker_line_width'],
                        states: {
                            hover: {
                                enabled: config['enableHover'] == undefined ? true : config['enableHover'],
                                lineColor: 'rgb(100,100,100)'
                            }
                        }
                    },
                    turboThreshold: config['turboThreshold'],
                    enableMouseTracking: config['enableMouseTracking'],
                    cursor: config['cursor'],
                    point: {
                        events: {
                            click: config['click_func']
                        }
                    }
                }
            },
            legend: {
                enabled: false
            },
            tooltip: {
                headerFormat: '',
                pointFormat: config['pointFormat'],
                useHTML: true,
                formatter: (function() {
                    if(!this.point.noTooltip) {
                        // Formatter function doesn't do name for some reason
                        fstring = config['pointFormat'].replace('{point.name}', this.point.name);
                        return Highcharts.Point.prototype.tooltipFormatter.call(this, fstring);
                    }
                    return false;
                })
            },
            series: [{
                color: config['marker_colour'],
                data: histogram(data, 10)
            }]
        },
        // Maintain aspect ratio as chart size changes
        function(this_chart){
            if(config['square']){
                var resizeCh = function(chart){
                    // Extra width for legend
                    var lWidth = chart.options.legend.enabled ? 30 : 0;
                    // Work out new chart width, assuming needs to be narrower
                    var chHeight = $(chart.renderTo).height();
                    var chWidth = $(chart.renderTo).width();
                    var nChHeight = chHeight;
                    var nChWidth = chHeight + lWidth;
                    // Chart is already too narrow, make it less tall
                    if(chWidth < nChWidth){
                        nChHeight = chWidth - lWidth;
                        nChWidth = chWidth;
                    }
                    chart.setSize(nChWidth, nChHeight);
                }
                // Resize on load
                resizeCh(this_chart);
                // Resize on graph resize
                $(this_chart.renderTo).on('mqc_plotresize', function(e){
                    resizeCh(this_chart);
                });
            }
        });
}

/**
 * Get histogram data out of xy data
 * @param   {Array} data  Array of tuples [x, y]
 * @param   {Number} step Resolution for the histogram
 * @returns {Array}       Histogram data
 */
function histogram(data, step) {
    var histo = {},
        x,
        i,
        arr = [];

    // Group down
    for (i = 0; i < data.length; i++) {
        x = Math.floor(data[i]['x'] / step) * step;
        if (!histo[x]) {
            histo[x] = 0;
        }
        histo[x]++;
    }

    // Make the histo group into an array
    for (x in histo) {
        if (histo.hasOwnProperty((x))) {
            arr.push([parseFloat(x), histo[x]]);
        }
    }

    // Finally, sort the array
    arr.sort(function (a, b) {
        return a[0] - b[0];
    });

    return arr;
}

// Scatter plot
function plot_scatter_plot (target, ds){
    if(mqc_plots[target] === undefined || mqc_plots[target]['plot_type'] !== 'scatter'){
        return false;
    }
    var config = mqc_plots[target]['config'];
    var data = mqc_plots[target]['datasets'];
    if(ds === undefined){ ds = 0; }

    if(config['marker_colour'] === undefined){ config['marker_colour'] = 'rgba(124, 181, 236, .5)'; }
    if(config['marker_size'] === undefined){ config['marker_size'] = 5; }
    if(config['marker_line_colour'] === undefined){ config['marker_line_colour'] = '#999'; }
    if(config['marker_line_width'] === undefined){ config['marker_line_width'] = 1; }
    if(config['tt_label'] === undefined){ config['tt_label'] = 'X: <strong>{point.x:.2f}</strong><br/>Y: <strong>{point.y:.2f}</strong>'; }
    if(config['click_func'] === undefined){ config['click_func'] = function(){ }; }
    else {
        config['click_func'] = eval("("+config['click_func']+")");
        if(config['cursor'] === undefined){ config['cursor'] = 'pointer'; }
    }
    if (config['xDecimals'] === undefined){ config['xDecimals'] = true; }
    if (config['yDecimals'] === undefined){ config['yDecimals'] = true; }
    if (config['pointFormat'] === undefined){
        config['pointFormat'] = '<div style="background-color:{point.color}; display:inline-block; height: 10px; width: 10px; border:1px solid #333;"></div> <span style="text-decoration:underline; font-weight:bold;">{point.name}</span><br>'+config['tt_label'];
    }

    // Make a clone of the data, so that we can mess with it,
    // while keeping the original data in tact
    var data = JSON.parse(JSON.stringify(mqc_plots[target]['datasets'][ds]));

    // Rename samples
    if(window.mqc_rename_f_texts.length > 0){
        $.each(data, function(j, s){
            $.each(window.mqc_rename_f_texts, function(idx, f_text){
                if(window.mqc_rename_regex_mode){
                    var re = new RegExp(f_text,"g");
                    data[j]['name'] = data[j]['name'].replace(re, window.mqc_rename_t_texts[idx]);
                } else {
                    data[j]['name'] = data[j]['name'].replace(f_text, window.mqc_rename_t_texts[idx]);
                }
            });
        });
    }

    // Highlight samples
    if(window.mqc_highlight_f_texts.length > 0){
        $.each(data, function(j, s){
            if ('marker' in data[j]){
                data[j]['marker']['lineWidth'] = 0;
            } else {
                data[j]['marker'] = {'lineWidth': 0};
            }
            var match = false;
            $.each(window.mqc_highlight_f_texts, function(idx, f_text){
                if(f_text == ''){ return true; }
                if((window.mqc_highlight_regex_mode && data[j]['name'].match(f_text)) || (!window.mqc_highlight_regex_mode && data[j]['name'].indexOf(f_text) > -1)){
                    data[j]['color'] = window.mqc_highlight_f_cols[idx];
                    match = true;
                }
            });
            if(!match) {
                data[j]['color'] = 'rgba(100,100,100,0.2)';
            }
        });
    }

    // Hide samples
    $('#'+target).closest('.mqc_hcplot_plotgroup').parent().find('.samples-hidden-warning').remove();
    $('#'+target).closest('.mqc_hcplot_plotgroup').show();
    if(window.mqc_hide_f_texts.length > 0){
        var num_hidden = 0;
        var num_total = data.length;
        var j = data.length;
        while (j--) {
            var match = false;
            for (i = 0; i < window.mqc_hide_f_texts.length; i++) {
                var f_text = window.mqc_hide_f_texts[i];
                if(window.mqc_hide_regex_mode){
                    if(data[j]['name'].match(f_text)){ match = true; }
                } else {
                    if(data[j]['name'].indexOf(f_text) > -1){ match = true; }
                }
            }
            if(window.mqc_hide_mode == 'show'){
                match = !match;
            }
            if(match){
                data.splice(j,1);
                num_hidden += 1;
            }
        };
        // Some series hidden. Show a warning text string.
        if(num_hidden > 0) {
            var alert = '<div class="samples-hidden-warning alert alert-warning"><span class="glyphicon glyphicon-info-sign"></span> <strong>Warning:</strong> '+num_hidden+' samples hidden. <a href="#mqc_hidesamples" class="alert-link" onclick="mqc_toolbox_openclose(\'#mqc_hidesamples\', true); return false;">See toolbox.</a></div>';
            $('#'+target).closest('.mqc_hcplot_plotgroup').before(alert);
        }
        // All series hidden. Hide the graph.
        if(num_hidden == num_total){
            $('#'+target).closest('.mqc_hcplot_plotgroup').hide();
            return false;
        }
    }

    // Make the highcharts plot
    Highcharts.chart(target, {
            chart: {
                type: 'scatter',
                zoomType: 'xy',
                plotBorderWidth: 1,
                height: config['square'] ? 500 : undefined,
                width: config['square'] ? 500 : undefined
            },
            title: {
                text: config['title'],
                x: 30 // fudge to center over plot area rather than whole plot
            },
            xAxis: {
                title: {
                    text: config['xlab']
                },
                type: config['xLog'] ? 'logarithmic' : 'linear',
                gridLineWidth: 1,
                categories: config['categories'],
                ceiling: config['xCeiling'],
                floor: config['xFloor'],
                max: config['xmax'],
                min: config['xmin'],
                minRange: config['xMinRange'],
                allowDecimals: config['xDecimals'],
                plotBands: config['xPlotBands'],
                plotLines: config['xPlotLines']
            },
            yAxis: {
                title: {
                    text: config['ylab']
                },
                type: config['yLog'] ? 'logarithmic' : 'linear',
                ceiling: config['yCeiling'],
                floor: config['yFloor'],
                max: config['ymax'],
                min: config['ymin'],
                minRange: config['yMinRange'],
                allowDecimals: config['yDecimals'],
                plotBands: config['yPlotBands'],
                plotLines: config['yPlotLines']
            },
            plotOptions: {
                series: {
                    animation: false,
                    marker: {
                        radius: config['marker_size'],
                        lineColor: config['marker_line_colour'],
                        lineWidth: config['marker_line_width'],
                        states: {
                            hover: {
                                enabled: config['enableHover'] == undefined ? true : config['enableHover'],
                                lineColor: 'rgb(100,100,100)'
                            }
                        }
                    },
                    turboThreshold: config['turboThreshold'],
                    enableMouseTracking: config['enableMouseTracking'],
                    cursor: config['cursor'],
                    point: {
                        events: {
                            click: config['click_func']
                        }
                    }
                }
            },
            legend: {
                enabled: false
            },
            tooltip: {
                headerFormat: '',
                pointFormat: config['pointFormat'],
                useHTML: true,
                formatter: (function() {
                    if(!this.point.noTooltip) {
                        // Formatter function doesn't do name for some reason
                        fstring = config['pointFormat'].replace('{point.name}', this.point.name);
                        return Highcharts.Point.prototype.tooltipFormatter.call(this, fstring);
                    }
                    return false;
                })
            },
            series: [{
                color: config['marker_colour'],
                data: data
            }]
        },
        // Maintain aspect ratio as chart size changes
        function(this_chart){
            if(config['square']){
                var resizeCh = function(chart){
                    // Extra width for legend
                    var lWidth = chart.options.legend.enabled ? 30 : 0;
                    // Work out new chart width, assuming needs to be narrower
                    var chHeight = $(chart.renderTo).height();
                    var chWidth = $(chart.renderTo).width();
                    var nChHeight = chHeight;
                    var nChWidth = chHeight + lWidth;
                    // Chart is already too narrow, make it less tall
                    if(chWidth < nChWidth){
                        nChHeight = chWidth - lWidth;
                        nChWidth = chWidth;
                    }
                    chart.setSize(nChWidth, nChHeight);
                }
                // Resize on load
                resizeCh(this_chart);
                // Resize on graph resize
                $(this_chart.renderTo).on('mqc_plotresize', function(e){
                    resizeCh(this_chart);
                });
            }
        });
}

// Beeswarm plot
function plot_beeswarm_graph(target, ds){
    if(mqc_plots[target] === undefined || mqc_plots[target]['plot_type'] !== 'beeswarm'){
        return false;
    }
    var config = mqc_plots[target]['config'];
    if(ds === undefined){ ds = 0; }

    // Make a clone of the data, so that we can mess with it,
    // while keeping the original data in tact
    var datasets = JSON.parse(JSON.stringify(mqc_plots[target]['datasets']));
    var samples = JSON.parse(JSON.stringify(mqc_plots[target]['samples']));
    var categories = JSON.parse(JSON.stringify(mqc_plots[target]['categories']));

    // Rename samples
    if(window.mqc_rename_f_texts.length > 0){
        for (i=0; i < samples.length; i++) {
            for (j=0; j < samples[i].length; j++) {
                $.each(window.mqc_rename_f_texts, function(idx, f_text){
                    if(window.mqc_rename_regex_mode){
                        var re = new RegExp(f_text,"g");
                        samples[i][j] = samples[i][j].replace(re, window.mqc_rename_t_texts[idx]);
                    } else {
                        samples[i][j] = samples[i][j].replace(f_text, window.mqc_rename_t_texts[idx]);
                    }
                });
            }
        }
    }

    // Highlight samples
    var baseColour = 'rgb(55,126,184)'; // Blue points by default
    var seriesColours = {};
    if(window.mqc_highlight_f_texts.length > 0){
        baseColour = 'rgb(80,80,80)'; // Grey points if no highlight
        for (i=0; i < samples.length; i++) {
            for (j=0; j < samples[i].length; j++) {
                $.each(window.mqc_highlight_f_texts, function(idx, f_text){
                    if((window.mqc_highlight_regex_mode && samples[i][j].match(f_text)) || (!window.mqc_highlight_regex_mode && samples[i][j].indexOf(f_text) > -1)){
                        seriesColours[samples[i][j]] = window.mqc_highlight_f_cols[idx];
                    }
                });
            }
        }
    }

    // Hide samples
    $('#'+target).closest('.hc-plot-wrapper').parent().find('.samples-hidden-warning').remove();
    $('#'+target).closest('.hc-plot-wrapper').show();
    if(window.mqc_hide_f_texts.length > 0){
        var num_hidden = 0;
        var num_total = 0;
        for (i=0; i < samples.length; i++) {
            num_total = Math.max(num_total, samples[i].length);
            var j = samples[i].length;
            var hidden_here = 0;
            while (j--) {
                var s_name = samples[i][j];
                var match = false;
                for (k = 0; k < window.mqc_hide_f_texts.length; k++) {
                    var f_text = window.mqc_hide_f_texts[k];
                    if(window.mqc_hide_regex_mode){
                        if(s_name.match(f_text)){ match = true; }
                    } else {
                        if(s_name.indexOf(f_text) > -1){ match = true; }
                    }
                }
                if(window.mqc_hide_mode == 'show'){
                    match = !match;
                }
                if(match){
                    samples[i].splice(j, 1);
                    datasets[i].splice(j, 1);
                    hidden_here += 1;
                }
            };
            num_hidden = Math.max(num_hidden, hidden_here);
        };
        // Some series hidden. Show a warning text string.
        if(num_hidden > 0) {
            var alert = '<div class="samples-hidden-warning alert alert-warning"><span class="glyphicon glyphicon-info-sign"></span> <strong>Warning:</strong> '+num_hidden+' samples hidden. <a href="#mqc_hidesamples" class="alert-link" onclick="mqc_toolbox_openclose(\'#mqc_hidesamples\', true); return false;">See toolbox.</a></div>';
            $('#'+target).closest('.hc-plot-wrapper').before(alert);
        }
        // All series hidden. Hide the graph.
        if(num_hidden == num_total){
            $('#'+target).closest('.hc-plot-wrapper').hide();
            return false;
        }
    }

    // Figure out how tall to make each plot
    var ph_min = 40;
    var ph_max = 100;
    var pheight = 600 / categories.length;
    pheight = Math.min(ph_max, Math.max(ph_min, pheight));

    // Clear the loading text and add hover text placeholder
    $('#'+target).html('<div class="beeswarm-hovertext"><em class="placeholder">Hover over a data point for more information</em></div><div class="beeswarm-plots"></div>');
    // Resize the parent draggable div
    $('#'+target).parent().css('height', ((pheight*categories.length)+40)+'px');

    for (var i = 0; i < categories.length; i++) {

        var borderCol = categories[i]['bordercol'];
        if (borderCol == undefined){
            borderCol = '#cccccc';
        }

        var data = datasets[i];
        var s_names = samples[i];
        if (categories[i]['namespace'] == ''){
            var label = categories[i]['title'];
            var label_long = categories[i]['description'];
        } else{
            var label = categories[i]['namespace'] + '<br/>' + categories[i]['title'];
            var label_long = categories[i]['namespace'] + ': ' + categories[i]['description'];
        }
        var ttSuffix = categories[i]['suffix'];
        var decimalPlaces = categories[i]['decimalPlaces'];
        var minx = categories[i]['min'];
        var maxx = categories[i]['max'];

        // Size and spacing options
        var markerRadius = 2.5
        var yspace = 70;
        var ysep = 10;
        if(data.length > 50){
            markerRadius = 1.8
            yspace = 50;
            ysep = 20;
        }
        if(data.length > 200){
            markerRadius = 1
            yspace = 30;
            ysep = 30;
        }

        if (maxx == undefined){
            maxx = Math.max.apply(null, data);
        }
        if (minx == undefined){
            minx = Math.max.apply(null, data);
        }
        var range = maxx-minx;
        var sep = range/yspace;
        // Get an array of indexes from a sorted data array
        // Leaves the data order in tact so we don't lose s_name association
        var indices = new Array(data.length);
        for (var n = 0; n < data.length; n++) { indices[n] = n; }
        indices.sort(function (a, b) {
            return data[a] < data[b] ? -1 : data[a] > data[b] ? 1 : 0;
        });
        var xydata = [];
        var last = undefined;
        var side = 1;
        for (var s_idx = 0; s_idx < indices.length; s_idx++) {
            row = indices[s_idx];
            s_name = s_names[row];
            d = data[row];
            if (Math.floor(d/sep) !== last){
                last = Math.floor(d/sep);
                side = 1;
            } else {
                side += 1;
            }
            multiplier = (side % 2 == 0) ? 1 : -1;
            var y = (Math.floor(side/2) * multiplier)/ysep;
            // Don't let jitter get too big
            while(y > 1 || y < -1){
                var n = Math.floor(Math.abs(y)) + 1;
                y = (Math.floor(side/2) * multiplier)/(ysep*n);
            }
            // Get the point colour
            var thisCol = baseColour;
            if(s_name in seriesColours) {
                thisCol = seriesColours[s_name];
            }
            xydata.push({
                'x':d,
                'y':y,
                'name':s_name,
                'color': thisCol
            });
        }

        $('<div class="beeswarm-plot" />')
            .appendTo('#'+target+' .beeswarm-plots')
            .css({
                'border-left': '2px solid '+borderCol,
                'height': (100/categories.length)+'%'
            })
            .highcharts({
                chart: {
                    type: 'scatter',
                    spacingTop: 0,
                    marginBottom: 0,
                    marginRight: 20,
                    marginLeft: 180,
                    backgroundColor: 'transparent',
                    // Horrible hacky HighCharts reflow problem.
                    // TODO: Come back and find a better solution!
                    events: {
                        load: function(chart) {
                            setTimeout(function(){
                                chart.target.reflow();
                            }, 200);
                        }
                    }
                },
                title: {
                    text: label,
                    align: 'left',
                    verticalAlign: 'middle',
                    y: 10,
                    useHTML: true,
                    style: {
                        fontSize: '12px'
                    }
                },
                yAxis: {
                    title: {text: null},
                    max: 1,
                    min: -1,
                    gridLineWidth: 0,
                    title: {text: null},
                    labels: {enabled: false},
                    lineWidth: 0
                },
                xAxis: {
                    lineWidth: 0,
                    tickWidth: 0,
                    tickPixelInterval: 200,
                    labels: {
                        reserveSpace: false,
                        y: (-1*(pheight/2))+5,
                        zIndex: 1,
                        style: {
                            color: '#999999'
                        }
                    },
                    min: minx,
                    max: maxx,
                },
                tooltip: {
                    valueSuffix: ttSuffix,
                    valueDecimals: decimalPlaces,
                    formatter: function(){
                        var value = Highcharts.numberFormat(this.point.x, this.series.tooltipOptions.valueDecimals);
                        var suff = this.series.tooltipOptions.valueSuffix;
                        var ttstring = '<span style="float:right;">'+this.series.name+'</span><samp>'+this.point.name+'</samp>: &nbsp; <strong>'+value+' '+suff+'</strong>';
                        $('#'+target+' .beeswarm-hovertext').html(ttstring);
                        return false;
                    }
                },
                plotOptions: {
                    series: {
                        name: label_long,
                        turboThreshold: 0,
                        marker: {
                            radius: markerRadius,
                            states: {
                                hover: {
                                    radiusPlus: 4,
                                    lineWidthPlus: 2,
                                    lineColor: '#333333'
                                }
                            }
                        },
                        stickyTracking: false,
                        point: {
                            events: {
                                mouseOver: function (e) {
                                    var hovName = this.name;
                                    $('#'+target+' .beeswarm-plot').each(function(){
                                        var plot = $(this).highcharts();
                                        for (i = 0; i < plot.series[0].data.length; ++i) {
                                            if(plot.series[0].data[i].name == hovName){
                                                plot.series[0].data[i].setState('hover');
                                            }
                                        }
                                    });

                                },
                                mouseOut: function () {
                                    $('#'+target+' .beeswarm-plot').each(function(){
                                        var plot = $(this).highcharts();
                                        for (i = 0; i < plot.series[0].data.length; ++i) {
                                            plot.series[0].data[i].setState();
                                        }
                                    });
                                    $('#'+target+' .beeswarm-hovertext').html('<em class="placeholder">Hover over a data point for more information</em>');
                                }
                            }
                        }
                    }
                },
                legend: { enabled: false },
                credits: { enabled: false },
                exporting: { enabled: false },
                series: [{
                    data: xydata,
                    // Workaround for HighCharts bug. See https://github.com/highcharts/highcharts/issues/1440
                    marker: { states: { hover: { fillColor: {} } } }
                }]

            });

    }
}

// Heatmap plot
function plot_heatmap(target, ds){
    if(mqc_plots[target] === undefined || mqc_plots[target]['plot_type'] !== 'heatmap'){
        return false;
    }
    var config = mqc_plots[target]['config'];

    if(config['square'] === undefined){ config['square'] = true; }

    // Make a clone of the data, so that we can mess with it,
    // while keeping the original data in tact
    var data = JSON.parse(JSON.stringify(mqc_plots[target]['data']));
    var xcats = JSON.parse(JSON.stringify(mqc_plots[target]['xcats']));
    var ycats = JSON.parse(JSON.stringify(mqc_plots[target]['ycats']));

    // Rename samples
    if(window.mqc_rename_f_texts.length > 0){
        for (i=0; i < xcats.length; i++) {
            $.each(window.mqc_rename_f_texts, function(idx, f_text){
                if(window.mqc_rename_regex_mode){
                    var re = new RegExp(f_text,"g");
                    xcats[i] = xcats[i].replace(re, window.mqc_rename_t_texts[idx]);
                } else {
                    xcats[i] = xcats[i].replace(f_text, window.mqc_rename_t_texts[idx]);
                }
            });
        }
        for (i=0; i < ycats.length; i++) {
            $.each(window.mqc_rename_f_texts, function(idx, f_text){
                if(window.mqc_rename_regex_mode){
                    var re = new RegExp(f_text,"g");
                    ycats[i] = ycats[i].replace(re, window.mqc_rename_t_texts[idx]);
                } else {
                    ycats[i] = ycats[i].replace(f_text, window.mqc_rename_t_texts[idx]);
                }
            });
        }
    }

    // Sort samples by highlight
    $('.mqc_heatmap_sortHighlight').attr('disabled', false);
    if(config['sortHighlights'] == true){
        if(window.mqc_highlight_f_texts.length > 0){
            // Collect the highlighting indices
            var xcat_hl = Array();
            var ycat_hl = Array();
            for (i=0; i < xcats.length; i++) {
                $.each(window.mqc_highlight_f_texts, function(idx, f_text){
                    if(f_text == ''){ xcat_hl[i] = 0; }
                    else if((window.mqc_highlight_regex_mode && xcats[i].match(f_text)) || (!window.mqc_highlight_regex_mode && xcats[i].indexOf(f_text) > -1)){
                        xcat_hl[i] = window.mqc_highlight_f_texts.length - idx;
                    }
                });
            }
            for (i=0; i < ycats.length; i++) {
                $.each(window.mqc_highlight_f_texts, function(idx, f_text){
                    if(f_text == ''){ ycat_hl[i] = 0; }
                    else if((window.mqc_highlight_regex_mode && ycats[i].match(f_text)) || (!window.mqc_highlight_regex_mode && ycats[i].indexOf(f_text) > -1)){
                        ycat_hl[i] = window.mqc_highlight_f_texts.length - idx;
                    }
                });
            }
            // Reshape the data - needs deepcopy as indexes are updated
            var newdata = JSON.parse(JSON.stringify(mqc_plots[target]['data']));
            var new_xcats = [], new_ycats = [];
            var xidx = 0, yidx = 0;
            for (hl = window.mqc_highlight_f_texts.length; hl >= 0; hl--){
                for (i=0; i < xcats.length; i++) {
                    if(xcat_hl[i] == hl){
                        new_xcats.push(xcats[i])
                        for (j=0; j < data.length; j++) {
                            if(data[j][0] == i){ newdata[j][0] = xidx; }
                        }
                        xidx += 1;
                    }
                }
                for (i=0; i < ycats.length; i++) {
                    if(ycat_hl[i] == hl){
                        new_ycats.push(ycats[i])
                        for (j=0; j < data.length; j++) {
                            if(data[j][1] == i){ newdata[j][1] = yidx; }
                        }
                        yidx += 1;
                    }
                }
            }
            data = newdata;
            xcats = new_xcats;
            ycats = new_ycats;
        }
    }

    // Hide samples
    var num_total = Math.max(xcats.length, ycats.length);
    $('#'+target).closest('.hc-plot-wrapper').parent().find('.samples-hidden-warning').remove();
    $('#'+target).closest('.hc-plot-wrapper').show();
    if(window.mqc_hide_f_texts.length > 0){
        var remove = Array();
        var i = xcats.length;
        var xhidden = 0;
        while (i--) {
            var match = false;
            for (j = 0; j < window.mqc_hide_f_texts.length; j++) {
                var f_text = window.mqc_hide_f_texts[j];
                if(window.mqc_hide_regex_mode){
                    if(xcats[i].match(f_text)){ match = true; }
                } else {
                    if(xcats[i].indexOf(f_text) > -1){ match = true; }
                }
            }
            if(window.mqc_hide_mode == 'show'){
                match = !match;
            }
            if(match){
                xcats.splice(i, 1);
                for (n=0; n < data.length; n++) {
                    var x = data[n][1];
                    if (x == i){ remove.push(n); }
                    else if(x > i){ data[n][1] -= 1; }
                }
                xhidden += 1;
            }
        }
        var i = ycats.length;
        var yhidden = 0;
        while (i--) {
            var match = false;
            for (j = 0; j < window.mqc_hide_f_texts.length; j++) {
                var f_text = window.mqc_hide_f_texts[j];
                if(window.mqc_hide_regex_mode){
                    if(ycats[i].match(f_text)){ match = true; }
                } else {
                    if(ycats[i].indexOf(f_text) > -1){ match = true; }
                }
            }
            if(window.mqc_hide_mode == 'show'){
                match = !match;
            }
            if(match){
                ycats.splice(i, 1);
                for (n=0; n < data.length; n++) {
                    var y = data[n][0];
                    if (y == i){
                        if(remove.indexOf(n) < 0){ remove.push(n); }
                    } else if(y > i){ data[n][0] -= 1; }
                }
                yhidden += 1;
            }
        }
        // Remove the data values that matched
        remove = remove.sort(function(a, b){return a-b}); // Sorts alphabetically by default, even with integers
        var r = remove.length;
        while(r--){
            data.splice( remove[r], 1);
        }
        // Report / hide the plot if we're hiding stuff
        var num_hidden = Math.max(xhidden, yhidden);
        // Some series hidden. Show a warning text string.
        if(num_hidden > 0) {
            var alert = '<div class="samples-hidden-warning alert alert-warning"><span class="glyphicon glyphicon-info-sign"></span> <strong>Warning:</strong> '+num_hidden+' samples hidden. <a href="#mqc_hidesamples" class="alert-link" onclick="mqc_toolbox_openclose(\'#mqc_hidesamples\', true); return false;">See toolbox.</a></div>';
            $('#'+target).closest('.hc-plot-wrapper').before(alert);
        }
        // All series hidden. Hide the graph.
        if(num_hidden >= num_total){
            $('#'+target).closest('.hc-plot-wrapper').hide();
            return false;
        }
    }

    // Highlight samples - do this last as we convert numerical arrays to associative
    if(window.mqc_highlight_f_texts.length > 0){
        $('.mqc_heatmap_sortHighlight').attr('disabled', false);
        var highlight_cells = Array();
        for (i=0; i < xcats.length; i++) {
            $.each(window.mqc_highlight_f_texts, function(idx, f_text){
                if(f_text == ''){ return true; }
                if((window.mqc_highlight_regex_mode && xcats[i].match(f_text)) || (!window.mqc_highlight_regex_mode && xcats[i].indexOf(f_text) > -1)){
                    for (n=0; n < data.length; n++) {
                        highlight_cells[idx] = ( typeof highlight_cells[idx] != 'undefined' && highlight_cells[idx] instanceof Array ) ? highlight_cells[idx] : [];
                        if (data[n][1] == i){ highlight_cells[idx].push(n); }
                    }
                }
            });
        }
        for (i=0; i < ycats.length; i++) {
            $.each(window.mqc_highlight_f_texts, function(idx, f_text){
                if(f_text == ''){ return true; }
                if((window.mqc_highlight_regex_mode && ycats[i].match(f_text)) || (!window.mqc_highlight_regex_mode && ycats[i].indexOf(f_text) > -1)){
                    for (n=0; n < data.length; n++) {
                        if (data[n][0] == i){
                            highlight_cells[idx] = ( typeof highlight_cells[idx] != 'undefined' && highlight_cells[idx] instanceof Array ) ? highlight_cells[idx] : [];
                            if(highlight_cells[idx].indexOf(n) < 0){ highlight_cells[idx].push(n); }
                        }
                    }
                }
            });
        }
        // Give highlighted cells a border
        for (var idx in highlight_cells){
            var hl = highlight_cells[idx];
            hl = hl.sort(function(a, b){return a-b}); // Sorts alphabetically by default, even with integers
            var h = hl.length;
            while(h--){
                var i = hl[h];
                data[i] = {
                    x: data[i][1] === undefined ? data[i]['x'] : data[i][1],
                    y: data[i][0] === undefined ? data[i]['y'] : data[i][0],
                    value:data[i][2] === undefined ? data[i]['value'] : data[i][2],
                    borderWidth:2,
                    borderColor: window.mqc_highlight_f_cols[idx]
                }
            }
        }
    } else {
        $('.mqc_heatmap_sortHighlight').attr('disabled', true);
    }

    // We set undefined config vars so that they stay the same when hiding samples
    if(config['min'] === undefined || config['max'] === undefined){
        var dmin = data[0][2];
        var dmax = data[0][2];
        for (n=0; n < data.length; n++) {
            dmin = Math.min(dmin, data[n][2]);
            dmax = Math.max(dmax, data[n][2]);
        }
        if(config['min'] === undefined){ config['min'] = dmin; }
        if(config['max'] === undefined){ config['max'] = dmax; }
    }
    if(config['colstops'] === undefined){
        config['colstops'] = [
            [0, '#313695'],
            [0.1, '#4575b4'],
            [0.2, '#74add1'],
            [0.3, '#abd9e9'],
            [0.4, '#e0f3f8'],
            [0.5, '#ffffbf'],
            [0.6, '#fee090'],
            [0.7, '#fdae61'],
            [0.8, '#f46d43'],
            [0.9, '#d73027'],
            [1, '#a50026'],
        ];
    }
    if(config['reverseColors'] === undefined){ config['reverseColors'] = false; }
    if(config['decimalPlaces'] === undefined){ config['decimalPlaces'] = 2; }
    if(config['legend'] === undefined){ config['legend'] = true; }
    if(config['borderWidth'] === undefined){ config['borderWidth'] = 0; }
    var datalabels = config['datalabels'];
    if(datalabels === undefined){
        if(data.length < 20){ datalabels = true; }
        else { datalabels = false; }
    }
    // Clone the colstops before we mess around with them
    var colstops = JSON.parse(JSON.stringify(config['colstops']));
    // Reverse the colour scale if the axis is reversed
    if(config['reverseColors']){
        for(var i = 0; i < colstops.length; i++){
            colstops[i][0] = 1 - colstops[i][0];
        }
        colstops.reverse();
    }

    // Make the highcharts plot
    Highcharts.chart(target, {
        chart: {
            type: 'heatmap',
            height: config['square'] ? 500 : undefined,
            width: config['square'] ? 530 : undefined,
            marginTop: config['title'] ? 60 : 50
        },
        plotOptions: {
            series: {
                point: {
                    events: {
                        mouseOver: function() {
                            // Stop highcharts making squares blue on hover
                            this.pointAttr.hover.fill = this.color;
                        }
                    }
                },
                states: {
                    hover: {
                        borderWidth: 2,
                        borderColor: 'red'
                    }
                }
            }
        },
        title: {
            text: config['title'],
        },
        xAxis: {
            endOnTick: false,
            maxPadding: 0,
            categories: xcats,
            title: { enabled: true, text: config['xTitle'] },
            labels: {
                formatter: function(){
                    try { return this.value.substr(0, 20); }
                    catch(err) { return this.value; }
                }
            }
        },
        yAxis: {
            endOnTick: false,
            maxPadding: 0,
            categories: ycats,
            reversed: true,
            opposite: true,
            title: config['yTitle'],
            labels: {
                formatter: function(){
                    try { return this.value.substr(0, 20); }
                    catch(err) { return this.value; }
                }
            }
        },
        colorAxis: {
            reversed: config['reverseColors'],
            stops: colstops,
            min: config['min'],
            max: config['max'],
        },
        legend: {
            align: 'right',
            layout: 'vertical',
            margin: 0,
            verticalAlign: 'top',
            y: 25,
            symbolHeight: 280,
            enabled: config['legend']
        },
        tooltip: {
            useHTML: true,
            formatter: function () {
                return 'X: <span style="font-weight:bold; font-family:monospace;">'+this.series.xAxis.categories[this.point.x] + '</span><br>' +
                    'Y: <span style="font-weight:bold; font-family:monospace;">' + this.series.yAxis.categories[this.point.y] + '</span><br>' +
                    '<div style="background-color:'+this.point.color+'; display:inline-block; height: 10px; width: 10px; border:1px solid #333;"></div> ' +
                    '<span style="font-weight: bold; text-decoration:underline;">' + Highcharts.numberFormat(this.point.value, config['decimalPlaces']) + '</span>'
            }
        },
        series: [{
            turboThreshold: 0,
            borderWidth: config['borderWidth'],
            data: data,
            dataLabels: {
                enabled: datalabels,
                format: '{point.value:.'+config['decimalPlaces']+'f}',
                color: config['datalabel_colour']
            }
        }]
    }, function(this_chart){
        // Maintain aspect ratio as chart size changes
        if(config['square']){
            var resizeCh = function(chart){
                // Extra width for legend
                var lWidth = chart.options.legend.enabled ? 30 : 0;
                // Work out new chart width, assuming needs to be narrower
                var chHeight = $(chart.renderTo).height();
                var chWidth = $(chart.renderTo).width();
                var nChHeight = chHeight;
                var nChWidth = chHeight + lWidth;
                // Chart is already too narrow, make it less tall
                if(chWidth < nChWidth){
                    nChHeight = chWidth - lWidth;
                    nChWidth = chWidth;
                }
                chart.setSize(nChWidth, nChHeight);
            }
            // Resize on load
            resizeCh(this_chart);
            // Resize on graph resize
            $(this_chart.renderTo).on('mqc_plotresize', function(e){
                try {
                    resizeCh(this_chart);
                } catch(e){
                    plot_heatmap($(this).attr('id'));
                }
            });
        }
    });

}

// Highlight text with a fadeout background colour highlight
function highlight_fade_text(obj){
    var orig_col = $(obj).css('color');
    obj.css({
        'display'          : 'inline-block',
        'background-color' : '#5bc0de',
        'color'            : '#FFFFFF',
        'WebkitTransition' : 'background-color 0s, color 0s',
        'MozTransition'    : 'background-color 0s, color 0s',
        'MsTransition'     : 'background-color 0s, color 0s',
        'OTransition'      : 'background-color 0s, color 0s',
        'transition'       : 'background-color 0s, color 0s'
    });
    setTimeout(function(){
        obj.css({
            'background-color' : '#FFFFFF',
            'color'            : orig_col,
            'WebkitTransition' : 'background-color 0.5s, color 0.5s',
            'MozTransition'    : 'background-color 0.5s, color 0.5s',
            'MsTransition'     : 'background-color 0.5s, color 0.5s',
            'OTransition'      : 'background-color 0.5s, color 0.5s',
            'transition'       : 'background-color 0.5s, color 0.5s'
        });
    }, 500);
}</script>
<script type="text/javascript">
    mqc_config = {}

</script>

</head>

<body>

<div class="side-nav-wrapper">
    <div class="side-nav">
        <h1>
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".mqc-nav, .mqc-toolbox">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="#">VariantQC
                <br class="hidden-xs">
                <small class="hidden-xs">v1.0</small>
            </a>
        </h1>

        <ul class="mqc-nav collapse navbar-collapse">

        </ul>
    </div>
    <!-- Nav Width Toggle Button -->
    <div id="side-nav-handle"><span class="glyphicon glyphicon-triangle-left" aria-hidden="true"></span></div>
</div>



<div class="mqc-toolbox collapse">

    <!-- Toolbar show/hide buttons -->
    <div class="mqc-toolbox-buttons hidden-xs">
        <a class="mqc-toolbox-label" href="#mqc_cols" title="Open Toolbox">Toolbox</a>
        <ul>
            <li><a href="#mqc_cols" title="Highlight" data-placement="left" data-toggle="tooltip"><span class="glyphicon glyphicon-pushpin"></span></a></li>
            <li><a href="#mqc_renamesamples" title="Rename" data-placement="left" data-toggle="tooltip"><span class="glyphicon glyphicon-font"></span></a></li>
            <li><a href="#mqc_hidesamples" title="Hide" data-placement="left" data-toggle="tooltip"><span class="glyphicon glyphicon-eye-close"></span></a></li>
            <li><a href="#mqc_exportplots" title="Export" data-placement="left" data-toggle="tooltip"><span class="glyphicon glyphicon-download-alt"></span></a></li>
            <li><a href="#mqc_about" title="About" data-placement="left" data-toggle="tooltip"><span class="glyphicon glyphicon-question-sign"></span></a></li>
        </ul>
    </div>


    <div class="mqc-toolbox-wrapper">
        <!-- Header - always visible -->
        <div class="mqc-toolbox-header hidden-xs">
            <h3>Toolbox</h3>
        </div>

        <!-- Highlighting -->
        <div id="mqc_cols" class="mqc_filter_section">
            <h4>
                <button id="mqc_cols_apply" class="btn btn-xs btn-default pull-right" disabled>Apply</button>
                Highlight Samples
            </h4>

            <form class="form-inline" id="mqc_color_form">
                <input id="mqc_colour_filter" type="text" placeholder="Custom Pattern" class="form-control input-sm">
                <input id="mqc_colour_filter_color" type="color" value="#e41a1c" class="form-control input-sm">
                <button type="submit" id="mqc_colour_filter_update" class="btn btn-default btn-sm">+</button>
            </form>
            <p class="mqc_regex_mode_p">
                <span class="mqc_switch_wrapper mqc_regex_mode">Regex mode <span class="mqc_switch re_mode off">off</span></span>
                <button class="btn btn-sm btn-link" data-toggle="modal" data-target="#regex_help_modal">help</button>
                <button class="btn btn-default btn-xs mqc_toolbox_clear"><span class="glyphicon glyphicon-trash"></span> Clear</button>
            </p>
            <ul id="mqc_col_filters" class="mqc_filters"></ul>
        </div>

        <!-- Renaming -->
        <div id="mqc_renamesamples" class="mqc_filter_section">
            <h4>
                <button id="mqc_rename_apply" class="btn btn-xs btn-default pull-right" disabled>Apply</button>
                Rename Samples
            </h4>

            <form class="form-inline" id="mqc_renamesamples_form">
                <input id="mqc_renamesamples_from" type="text" placeholder="From" class="form-control input-sm">
                <input id="mqc_renamesamples_to" type="text" placeholder="To" class="form-control input-sm">
                <button type="submit" id="mqc_renamesamples_filter_update" class="btn btn-default btn-sm">+</button>
            </form>
            <p><a data-toggle="collapse" href="#mqc_renamesamples_bulk_collapse">Click here for bulk input.</a></p>
            <div class="collapse" id="mqc_renamesamples_bulk_collapse">
                <p>Paste two columns of a tab-delimited table here (eg. from Excel).</p>
                <p>First column should be the old name, second column the new name.</p>
                <form id="mqc_renamesamples_bulk_form">
                    <textarea class="form-control" rows="5"></textarea>
                    <button type="submit" id="mqc_renamesamples_bulk_update" class="btn btn-default btn-sm">Add</button>
                </form>
            </div>
            <p class="mqc_regex_mode_p">
                <span class="mqc_switch_wrapper mqc_regex_mode">Regex mode <span class="mqc_switch re_mode off">off</span></span>
                <button class="btn btn-sm btn-link" data-toggle="modal" data-target="#regex_help_modal">help</button>
                <button class="btn btn-default btn-xs mqc_toolbox_clear"><span class="glyphicon glyphicon-trash"></span> Clear</button>
            </p>
            <ul id="mqc_renamesamples_filters" class="mqc_filters"></ul>
        </div>

        <!-- Hiding -->
        <div id="mqc_hidesamples" class="mqc_filter_section">
            <h4>
                <button id="mqc_hide_apply" class="btn btn-xs btn-default pull-right" disabled>Apply</button>
                Show / Hide Samples
            </h4>

            <form id="mqc_hidesamples_form">
                <div class="radio input-sm">
                    <label><input type="radio" name="mqc_hidesamples_showhide" class="mqc_hidesamples_showhide" value="hide" checked> Hide matching samples</label>
                </div>
                <div class="radio input-sm">
                    <label><input type="radio" name="mqc_hidesamples_showhide" class="mqc_hidesamples_showhide" value="show"> Show only matching samples</label>
                </div>
                <div class="form-inline">
                    <input id="mqc_hidesamples_filter" type="text" placeholder="Custom Pattern" class="form-control input-sm">
                    <button type="submit" id="mqc_hidesamples_filter_update" class="btn btn-default btn-sm">+</button>
                </div>
            </form>

            <p class="mqc_regex_mode_p">
                <span class="mqc_switch_wrapper mqc_regex_mode">Regex mode <span class="mqc_switch re_mode off">off</span></span>
                <button class="btn btn-sm btn-link" data-toggle="modal" data-target="#regex_help_modal">help</button>
                <button class="btn btn-default btn-xs mqc_toolbox_clear"><span class="glyphicon glyphicon-trash"></span> Clear</button>
            </p>
            <ul id="mqc_hidesamples_filters" class="mqc_filters"></ul>
        </div>

        <!-- Export Plots -->
        <div id="mqc_exportplots" class="mqc_filter_section">
            <h4>Export Plots</h4>
            <form>
                <ul class="nav nav-tabs" role="tablist">
                    <li class="active"><a href="#mqc_image_download" data-toggle="tab">Images</a></li>
                    <li><a href="#mqc_data_download" data-toggle="tab">Data</a></li>
                </ul>
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane fade in active" id="mqc_image_download">
                        <div class="row">
                            <div class="form-group col-sm-6">
                                <div class="input-group input-group-sm">
                                    <input type="text" class="form-control input-sm" id="mqc_exp_width" placeholder="Width" value="1200">
                                    <span class="input-group-addon">px</span>
                                </div>
                            </div>
                            <div class="form-group col-sm-6">
                                <div class="input-group input-group-sm">
                                    <input type="text" class="form-control input-sm" id="mqc_exp_height" placeholder="Height" value="800">
                                    <span class="input-group-addon">px</span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col-sm-6 checkbox">
                                <label><input type="checkbox" id="mqc_export_aspratio" checked> Aspect ratio</label>
                            </div>
                            <div class="form-group col-sm-6">
                                <select id="mqc_export_ft" class="form-control input-sm">
                                    <option value="image/png">PNG</option>
                                    <option value="image/jpeg">JPEG</option>
                                    <option value="image/svg+xml">SVG</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6 checkbox">
                                <label for="mqc_export_scaling">Plot scaling</label>
                            </div>
                            <div class="col-sm-6">
                                <div class="input-group input-group-sm">
                                    <input type="text" class="form-control" id="mqc_export_scaling" placeholder="Scale" value="2">
                                    <span class="input-group-addon">X</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div role="tabpanel" class="tab-pane fade" id="mqc_data_download">
                        <p>Download the raw data used to create the plots in this report below:</p>
                        <div class="row">
                            <div class="form-group col-sm-4 checkbox">
                                <label>Format:</label>
                            </div>
                            <div class="form-group col-sm-8">
                                <select id="mqc_export_data_ft" class="form-control input-sm">
                                    <option value="tsv">Tab-separated</option>
                                    <option value="csv">Comma-separated</option>
                                    <option value="json">JSON</option>
                                </select>
                            </div>
                        </div>

                        <p>Note that additional data was saved in <code>variantqc_data</code> when this report was generated.</p>

                        <div id="mqc_export_data_log"></div>
                    </div>
                </div>

                <hr>
                <h5>Choose Plots</h5>
                <button class="btn btn-sm btn-default" id="mqc_export_sall"><span class="glyphicon glyphicon-check"></span> All</button>
                <button class="btn btn-sm btn-default" id="mqc_export_snone"><span class="glyphicon glyphicon-unchecked"></span> None</button>
                <div id="mqc_export_selectplots"></div>

                <hr>
                <button type="submit" class="btn btn-block btn-default"><span class="glyphicon glyphicon-download-alt"></span> &nbsp; Download Plot <span id="mqc-dl-plot-txt">Images</span></button>
                <p><small>This report is based heavily on MultiQC.  If you use plots from VariantQC in a publication or presentation, please cite:</small></p>
                <blockquote>
                    <strong>MultiQC: Summarize analysis results for multiple tools and samples in a single report</strong><br>
                    <em>Philip Ewels, M&aring;ns Magnusson, Sverker Lundin and Max K&auml;ller</em><br>
                    Bioinformatics (2016)<br>
                    doi: <a href="http://dx.doi.org/10.1093/bioinformatics/btw354" target="_blank">10.1093/bioinformatics/btw354</a><br>
                    PMID: <a href="http://www.ncbi.nlm.nih.gov/pubmed/27312411" target="_blank">27312411</a>
                </blockquote>
            </form>
        </div>

        <!-- Help / About -->
        <div id="mqc_about" class="mqc_filter_section">
            <h4>About VariantQC</h4>
            <p>This report was generated using VariantQC, version *DevelopmentVersion*</p>
            <p>For more information about VariantQC, please visit <a href="https://bimberlab.github.io/DISCVRSeq/" target="_blank">https://bimberlab.github.io/DISCVRSeq/</a></p>
            <p>You can report bugs, suggest improvements and find the source code for VariantQC on GitHub:
                <a href="https://github.com/BimberLab/DISCVRseq" target="_blank">https://github.com/BimberLab/DISCVRseq</a></p>
            <!--<p>VariantQC is published in Bioinformatics:</p>-->
            <!--<blockquote>-->
                <!--<strong>TODO</strong><br>-->
                <!--<em>Authors</em><br>-->
                <!--journal<br>-->
                <!--PMID: <a href="http://www.ncbi.nlm.nih.gov/pubmed/XXXXXXX" target="_blank">XXXXXXX</a>-->
            <!--</blockquote>-->
        </div>

    </div>
    <a href="#top" class="mqc-toplink hidden-xs" title="Go to top"><span class="glyphicon glyphicon-chevron-up"></span></a>
</div>

<div class="mainpage">



    <h1 id="page_title">

        <a href="https://github.com/BimberLab/DISCVRSeq" target="_blank">
            VariantQC
        </a>
    </h1>



    <p class="lead">
        This report was generated by VariantQC, a tool to generate summary stats from VCFs.
    </p>




    <div id="analysis_dirs_wrapper">
        <p id="dateTime"></p>
    </div>

    <div id="section_wrapper">
        <p class="lead">
            &#8592; Make a selection on the left to view specific summary stats.
        </p>
    </div>




</div>

<div class="footer">
    <div class="container-fluid">
        <p>
            <strong>
                <a href="#" target="_blank">VariantQC *DevelopmentVersion*</a>
            </strong>
            - Written by Ben Bimber and Melissa Yan,
            available on <a href="https://github.com/BimberLab/DISCVRSeq" target="_blank">GitHub</a>.
        </p>
        <p>
            This report uses
            <a href="https://github.com/ewels/MultiQC/" target="_blank">MultiQC</a>,
            <a href="http://www.highcharts.com/" target="_blank">HighCharts</a>,
            <a href="https://jquery.com/" target="_blank">jQuery</a>,
            <a href="https://jqueryui.com/" target="_blank">jQuery UI</a>,
            <a href="http://getbootstrap.com/" target="_blank">Bootstrap</a>,
            <a href="https://github.com/gka/chroma.js" target="_blank">chroma.js</a>,
            <a href="https://github.com/eligrey/FileSaver.js" target="_blank">FileSaver.js</a> and
            <a href="https://clipboardjs.com/" target="_blank">clipboard.js</a>.
        </p>
    </div>
</div>




<!-- Table Scatter Plot Modal -->
<div class="modal fade" id="tableScatterModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title">Plot Table Data</h3>
            </div>
            <div class="modal-body">
                <form id="tableScatterForm">
                    <input type="hidden" id="tableScatter_tid" name="tableScatter_tid" value="" />
                    <div class="row">
                        <div class="col-sm-6">
                            <select id="tableScatter_col1" name="tableScatter_col1" class="form-control">
                                <option value="">Select Column</option>
                            </select>
                        </div>
                        <div class="col-sm-6">
                            <select id="tableScatter_col2" name="tableScatter_col2" class="form-control">
                                <option value="">Select Column</option>
                            </select>
                        </div>
                    </div>
                    <div class="hc-plot-wrapper">
                        <div id="tableScatterPlot" class="hc-plot not_rendered hc-scatter-plot no-handle" style="width:566px; height: 510px;">
                            <small>Please select two table columns.</small>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>



<!-- Regex Help Modal -->
<div class="modal fade" id="regex_help_modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title">Regex Help</h3>
            </div>
            <div class="modal-body">
                <p>Toolbox search strings can behave as regular expressions (regexes). Click a button below to see an example of it in action. Try modifying them yourself in the text box.</p>
                <div class="row">
                    <div class="col-sm-6 regex_example_buttons">
                        <button class="btn btn-default" data-example="^samp_1"><code>^</code> (start of string)</button>
                        <button class="btn btn-default" data-example="samp_1$"><code>$</code> (end of string)</button>
                        <button class="btn btn-default" data-example="samp_[13]"><code>[]</code> (character choice)</button>
                        <button class="btn btn-default" data-example="\d$"><code>\d</code> (shorthand for <code>[0-9]</code>)</button>
                        <button class="btn btn-default" data-example="^\w"><code>\w</code> (shorthand for <code>[0-9a-zA-Z_]</code>)</button>
                        <button class="btn btn-default" data-example="._samp"><code>.</code> (any character)</button>
                        <button class="btn btn-default" data-example="\."><code>\.</code> (literal full stop)</button>
                        <button class="btn btn-default" data-example="(tmp|prepended)_samp"><code>()</code> <code>|</code> (group / separator)</button>
                        <button class="btn btn-default" data-example="tmpp*_"><code>*</code> (prev char 0 or more)</button>
                        <button class="btn btn-default" data-example="tmpp+_"><code>+</code> (prev char 1 or more)</button>
                        <button class="btn btn-default" data-example="tmpp?_"><code>?</code> (prev char 0 or 1)</button>
                        <button class="btn btn-default" data-example="_1{5}"><code>{}</code> (char num times)</button>
                        <button class="btn btn-default" data-example="_1{2,5}"><code>{,}</code> (count range)</button>
                    </div>
                    <div class="col-sm-6 regex_example_demo">
                        <input type="text" class="form-control" />
                        <pre>
                        <span>samp_1</span>
                        <span>samp_1_edited</span>
                        <span>samp_2</span>
                        <span>samp_2_edited</span>
                        <span>samp_3</span>
                        <span>samp_3_edited</span>
                        <span>prepended_samp_1</span>
                        <span>tmp_samp_1_edited</span>
                        <span>tmpp_samp_1_edited</span>
                        <span>tmppp_samp_1_edited</span>
                        <span>#samp_1_edited.tmp</span>
                        <span>samp_11</span>
                        <span>samp_11111</span>
                        </pre>
                        <p>See <a href="https://regex101.com/" target="_blank">regex101.com</a> for a more heavy duty testing suite.</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>
